UNSAFEGUARDED IMPLEMENTATION MODULE OOle2;

FROM SYSTEM IMPORT
    CAST, ADDRESS, UNREFERENCED_PARAMETER;

FROM WIN32 IMPORT
    BYTE, LONG, ULONG, SHORT, BOOL, WORD,
    SCODE, PSHORT, PLONG, LCID, WFLOAT, LPFLOAT;

FROM RPCCore IMPORT
    GUID, IID, CLSID;

<*/Foreign*>
<*/NOWARN:I*>
<*/CALLS:StonyBrook*>
<*/NOHIGH*>

ABSTRACT CLASS IUnknown;
END IUnknown;

ABSTRACT CLASS ITypeInfo;
END ITypeInfo;

ABSTRACT CLASS ITypeComp;
END ITypeComp;

ABSTRACT CLASS ITypeLib;
END ITypeLib;

ABSTRACT CLASS IDispatch;
END IDispatch;

ABSTRACT CLASS IClassFactory;
END IClassFactory;

ABSTRACT CLASS IEnumSTATSTG;
END IEnumSTATSTG;

ABSTRACT CLASS ISequentialStream;
END ISequentialStream;

ABSTRACT CLASS IStream;
END IStream;

ABSTRACT CLASS IStorage;
END IStorage;

ABSTRACT CLASS IEnumFORMATETC;
END IEnumFORMATETC;

ABSTRACT CLASS IAdviseSink;
END IAdviseSink;

ABSTRACT CLASS IAdviseSink2;
END IAdviseSink2;

ABSTRACT CLASS IEnumString;
END IEnumString;

ABSTRACT CLASS IEnumMoniker;
END IEnumMoniker;

ABSTRACT CLASS IEnumUnknown;
END IEnumUnknown;

ABSTRACT CLASS IEnumSTATDATA;
END IEnumSTATDATA;

ABSTRACT CLASS IPersist;
END IPersist;

ABSTRACT CLASS IPersistStream;
END IPersistStream;

ABSTRACT CLASS IRpcChannelBuffer;
END IRpcChannelBuffer;

ABSTRACT CLASS IRpcStubBuffer;
END IRpcStubBuffer;

ABSTRACT CLASS IRunningObjectTable;
END IRunningObjectTable;

ABSTRACT CLASS IBindCtx;
END IBindCtx;

ABSTRACT CLASS IMoniker;
END IMoniker;

ABSTRACT CLASS IMarshal;
END IMarshal;

ABSTRACT CLASS IMalloc;
END IMalloc;

ABSTRACT CLASS IMallocSpy;
END IMallocSpy;

ABSTRACT CLASS IStdMarshalInfo;
END IStdMarshalInfo;

ABSTRACT CLASS IExternalConnection;
END IExternalConnection;

ABSTRACT CLASS IRunnableObject;
END IRunnableObject;

ABSTRACT CLASS IPersistFile;
END IPersistFile;

ABSTRACT CLASS IPersistStorage;
END IPersistStorage;

ABSTRACT CLASS ILockBytes;
END ILockBytes;

ABSTRACT CLASS IRootStorage;
END IRootStorage;

ABSTRACT CLASS IDataObject;
END IDataObject;

ABSTRACT CLASS IDataAdviseHolder;
END IDataAdviseHolder;

ABSTRACT CLASS IMessageFilter;
END IMessageFilter;

ABSTRACT CLASS IRpcProxyBuffer;
END IRpcProxyBuffer;

ABSTRACT CLASS IPSFactoryBuffer;
END IPSFactoryBuffer;

ABSTRACT CLASS ICreateTypeInfo;
END ICreateTypeInfo;

ABSTRACT CLASS ICreateTypeLib;
END ICreateTypeLib;

ABSTRACT CLASS IEnumVARIANT;
END IEnumVARIANT;

ABSTRACT CLASS IErrorInfo;
END IErrorInfo;

ABSTRACT CLASS ICreateErrorInfo;
END ICreateErrorInfo;

ABSTRACT CLASS ISupportErrorInfo;
END ISupportErrorInfo;

ABSTRACT CLASS IOleAdviseHolder;
END IOleAdviseHolder;

ABSTRACT CLASS IOleCache;
END IOleCache;

ABSTRACT CLASS IOleCache2;
END IOleCache2;

ABSTRACT CLASS IOleCacheControl;
END IOleCacheControl;

ABSTRACT CLASS IParseDisplayName;
END IParseDisplayName;

ABSTRACT CLASS IOleContainer;
END IOleContainer;

ABSTRACT CLASS IOleClientSite;
END IOleClientSite;

ABSTRACT CLASS IEnumOLEVERB;
END IEnumOLEVERB;

ABSTRACT CLASS IOleObject;
END IOleObject;

ABSTRACT CLASS IOleWindow;
END IOleWindow;

ABSTRACT CLASS IOleLink;
END IOleLink;

ABSTRACT CLASS IOleItemContainer;
END IOleItemContainer;

ABSTRACT CLASS IOleInPlaceUIWindow;
END IOleInPlaceUIWindow;

ABSTRACT CLASS IOleInPlaceActiveObject;
END IOleInPlaceActiveObject;

ABSTRACT CLASS IOleInPlaceFrame;
END IOleInPlaceFrame;

ABSTRACT CLASS IOleInPlaceObject;
END IOleInPlaceObject;

ABSTRACT CLASS IOleInPlaceSite;
END IOleInPlaceSite;

ABSTRACT CLASS IViewObject;
END IViewObject;

ABSTRACT CLASS IViewObject2;
END IViewObject2;

ABSTRACT CLASS IDropSource;
END IDropSource;

ABSTRACT CLASS IDropTarget;
END IDropTarget;

ABSTRACT CLASS IRecordInfo;
END IRecordInfo;

PROCEDURE IsEqualGUID(rguid1 : GUID; rguid2 : GUID) : BOOL;
BEGIN
    RETURN (rguid1.Data1 = rguid2.Data1) AND
               (rguid1.Data2 = rguid2.Data2) AND
           (rguid1.Data3 = rguid2.Data3) AND
           (rguid1.Data4[0]:CARDINAL = rguid2.Data4[0]: CARDINAL) AND
           (rguid1.Data4[4]:CARDINAL = rguid2.Data4[4]: CARDINAL);
END IsEqualGUID;

PROCEDURE IsEqualIID(riid1 : IID; riid2 : IID) : BOOL;
BEGIN
    RETURN IsEqualGUID(riid1, riid2);
END IsEqualIID;

PROCEDURE IsEqualCLSID(rclsid1 : CLSID; rclsid2 : CLSID) : BOOL;
BEGIN
    RETURN IsEqualGUID(rclsid1, rclsid2);
END IsEqualCLSID;


(* MACRO V *)
PROCEDURE V_VT(X : LPVARIANT) : WORD;
BEGIN
    RETURN X^.vt;
END V_VT;

PROCEDURE V_ISBYREF(X : LPVARIANT) : BOOL;
BEGIN
    RETURN (V_VT(X) BAND VT_BYREF) = VT_BYREF;
END V_ISBYREF;

PROCEDURE V_ISARRAY(X : LPVARIANT) : BOOL;
BEGIN
     RETURN (V_VT(X) BAND VT_ARRAY) = VT_ARRAY;
END V_ISARRAY;

PROCEDURE V_ISVECTOR(X : LPVARIANT) : BOOL;
BEGIN
    RETURN (V_VT(X) BAND VT_VECTOR) = VT_VECTOR;
END V_ISVECTOR;

PROCEDURE V_NONE(X : LPVARIANT) : SHORT;
BEGIN
    RETURN X^.iVal;
END V_NONE;

PROCEDURE V_UI1(X : LPVARIANT) : BYTE;
BEGIN
    RETURN X^.bVal;
END V_UI1;

PROCEDURE V_UI1REF(X : LPVARIANT) : ADDRESS;
BEGIN
    RETURN X^.pbVal;
END V_UI1REF;

PROCEDURE V_I2(X : LPVARIANT) : SHORT;
BEGIN
    RETURN X^.iVal;
END V_I2;

PROCEDURE V_I2REF(X : LPVARIANT) : PSHORT;
BEGIN
      RETURN X^.piVal;
END V_I2REF;

PROCEDURE V_I4(X : LPVARIANT) : LONG;
BEGIN
    RETURN X^.lVal;
END V_I4;

PROCEDURE V_I4REF(X : LPVARIANT) : PLONG;
BEGIN
    RETURN X^.plVal;
END V_I4REF;

PROCEDURE V_R4(X : LPVARIANT) : WFLOAT;
BEGIN
    RETURN X^.fltVal;
END V_R4;

PROCEDURE V_R4REF(X : LPVARIANT) : LPFLOAT;
BEGIN
    RETURN X^.pfltVal;
END V_R4REF;

PROCEDURE V_R8(X : LPVARIANT) : LONGREAL;
BEGIN
    RETURN X^.dblVal;
END V_R8;

PROCEDURE V_R8REF(X : LPVARIANT) : PLONGREAL;
BEGIN
    RETURN X^.pdblVal;
END V_R8REF;

PROCEDURE V_CY(X : LPVARIANT)  : CY;
BEGIN
    RETURN X^.cyVal;
END V_CY;

PROCEDURE V_CYREF(X : LPVARIANT) : PCY;
BEGIN
    RETURN X^.pcyVal;
END V_CYREF;

PROCEDURE V_DATE(X : LPVARIANT) : DATE;
BEGIN
    RETURN X^.date;
END V_DATE;

PROCEDURE V_DATEREF(X : LPVARIANT) : LPDATE;
BEGIN
    RETURN X^.pdate;
END V_DATEREF;

PROCEDURE V_BSTR(X : LPVARIANT) : BSTR;
BEGIN
    RETURN X^.bstrVal;
END V_BSTR;

PROCEDURE V_BSTRREF(X : LPVARIANT) : LPBSTR;
BEGIN
    RETURN X^.pbstrVal;
END V_BSTRREF;

PROCEDURE V_DISPATCH(X : LPVARIANT) : IDispatch;
BEGIN
    RETURN X^.pdispVal;
END V_DISPATCH;

PROCEDURE V_DISPATCHREF(X : LPVARIANT) : PPDispatch;
BEGIN
    RETURN X^.ppdispVal;
END V_DISPATCHREF;

PROCEDURE V_ERROR(X : LPVARIANT) : SCODE;
BEGIN
    RETURN X^.scode;
END V_ERROR;

PROCEDURE V_ERRORREF(X : LPVARIANT) : LPSCODE;
BEGIN
    RETURN X^.pscode;
END V_ERRORREF;

PROCEDURE V_BOOL(X : LPVARIANT) : VARIANT_BOOL;
BEGIN
    RETURN X^.bool;
END V_BOOL;

PROCEDURE V_BOOLREF(X : LPVARIANT) : PVARIANT_BOOL;
BEGIN
    RETURN X^.pbool;
END V_BOOLREF;

PROCEDURE V_UNKNOWN(X : LPVARIANT) : IUnknown;
BEGIN
    RETURN X^.punkVal;
END V_UNKNOWN;

PROCEDURE V_UNKNOWNREF(X : LPVARIANT) : PPUnknown;
BEGIN
    RETURN X^.ppunkVal;
END V_UNKNOWNREF;

PROCEDURE V_VARIANTREF(X : LPVARIANT) : LPVARIANT;
BEGIN
    RETURN X^.pvarVal;
END V_VARIANTREF;


PROCEDURE V_ARRAY(X : LPVARIANT) : LPSAFEARRAY;
BEGIN
    RETURN X^.parray;
END V_ARRAY;

PROCEDURE V_ARRAYREF(X : LPVARIANT) : LPLPSAFEARRAY;
BEGIN
    RETURN X^.pparray;
END V_ARRAYREF;

PROCEDURE V_BYREF(X : LPVARIANT) : ADDRESS;
BEGIN
    RETURN X^.byref;
END V_BYREF;

PROCEDURE TYPEKIND_to_xmit(Enum : TYPEKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END TYPEKIND_to_xmit;

PROCEDURE TYPEKIND_from_xmit(Long : LONG; VAR pEnum : TYPEKIND);
BEGIN
    pEnum := CAST(TYPEKIND, Long);
END TYPEKIND_from_xmit;

PROCEDURE TYPEKIND_free_inst(Enum : TYPEKIND);
BEGIN
    UNREFERENCED_PARAMETER(Enum);
END TYPEKIND_free_inst;

PROCEDURE TYPEKIND_free_xmit(Long : LONG);
BEGIN
    UNREFERENCED_PARAMETER(Long);
END TYPEKIND_free_xmit;

PROCEDURE CALLCONV_to_xmit(Enum : CALLCONV; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END CALLCONV_to_xmit;

PROCEDURE CALLCONV_from_xmit(Long : LONG; VAR Enum : CALLCONV);
BEGIN
    Enum := CAST(CALLCONV, Long);
END CALLCONV_from_xmit;

PROCEDURE CALLCONV_free_inst(pEnum : CALLCONV);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END CALLCONV_free_inst;

PROCEDURE CALLCONV_free_xmit(pLong : LONG) ;
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END CALLCONV_free_xmit;

PROCEDURE FUNCKIND_to_xmit(Enum : FUNCKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END FUNCKIND_to_xmit;

PROCEDURE FUNCKIND_from_xmit(Long : LONG; VAR Enum : FUNCKIND);
BEGIN
    Enum := CAST(FUNCKIND, Long);
END FUNCKIND_from_xmit;

PROCEDURE FUNCKIND_free_inst(pEnum : FUNCKIND);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END FUNCKIND_free_inst;

PROCEDURE FUNCKIND_free_xmit(pLong : LONG) ;
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END FUNCKIND_free_xmit;

PROCEDURE INVOKEKIND_to_xmit(Enum : INVOKEKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END INVOKEKIND_to_xmit;

PROCEDURE INVOKEKIND_from_xmit(Long : LONG; VAR Enum : INVOKEKIND);
BEGIN
    Enum := CAST(INVOKEKIND, Long);
END INVOKEKIND_from_xmit;

PROCEDURE INVOKEKIND_free_inst(pEnum : INVOKEKIND);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END INVOKEKIND_free_inst;

PROCEDURE INVOKEKIND_free_xmit(pLong : LONG) ;
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END INVOKEKIND_free_xmit;

PROCEDURE VARKIND_to_xmit(Enum : VARKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END VARKIND_to_xmit;

PROCEDURE VARKIND_from_xmit(Long : LONG; VAR Enum : VARKIND);
BEGIN
    Enum := CAST(VARKIND, Long);
END VARKIND_from_xmit;

PROCEDURE VARKIND_free_inst(pEnum : VARKIND);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END VARKIND_free_inst;

PROCEDURE VARKIND_free_xmit(pLong : LONG) ;
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END VARKIND_free_xmit;

PROCEDURE DESCKIND_to_xmit(Enum : DESCKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END DESCKIND_to_xmit;

PROCEDURE DESCKIND_from_xmit(Long : LONG; VAR Enum : DESCKIND);
BEGIN
    Enum := CAST(DESCKIND, Long);
END DESCKIND_from_xmit;

PROCEDURE DESCKIND_free_inst(pEnum : DESCKIND);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END DESCKIND_free_inst;

PROCEDURE DESCKIND_free_xmit(pLong : LONG) ;
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END DESCKIND_free_xmit;

PROCEDURE SYSKIND_to_xmit(Enum : SYSKIND; VAR Long : LONG);
BEGIN
    Long := CAST(LONG, Enum);
END SYSKIND_to_xmit;

PROCEDURE SYSKIND_from_xmit(Long : LONG; VAR Enum : SYSKIND);
BEGIN
    Enum := CAST(SYSKIND, Long);
END SYSKIND_from_xmit;

PROCEDURE SYSKIND_free_inst(pEnum : SYSKIND);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END SYSKIND_free_inst;

PROCEDURE SYSKIND_free_xmit(pLong : LONG);
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END SYSKIND_free_xmit;

PROCEDURE DISCARDCACHE_to_xmit(pEnum : DISCARDCACHE; VAR ppLong : LONG);
BEGIN
    ppLong := CAST(LONG, pEnum);
END DISCARDCACHE_to_xmit;

PROCEDURE DISCARDCACHE_from_xmit(pLong : LONG; pEnum : DISCARDCACHE);
BEGIN
    pEnum := CAST(DISCARDCACHE, pLong);
END DISCARDCACHE_from_xmit;

PROCEDURE DISCARDCACHE_free_inst(pEnum : DISCARDCACHE);
BEGIN
    UNREFERENCED_PARAMETER(pEnum);
END DISCARDCACHE_free_inst;

PROCEDURE DISCARDCACHE_free_xmit(pLong : LONG);
BEGIN
    UNREFERENCED_PARAMETER(pLong);
END DISCARDCACHE_free_xmit;

PROCEDURE LHashValOfName(lcid : LCID; szName : ARRAY OF OLECHAR) : ULONG;
BEGIN
    RETURN LHashValOfNameSys(SYS_WIN32, lcid, szName);
END LHashValOfName;

PROCEDURE WHashValOfLHashVal(lhashval : ULONG) : WORD;
BEGIN
    RETURN 0000ffffh BAND lhashval;
END WHashValOfLHashVal;

PROCEDURE IsHashValCompatible(lhashval1 : ULONG; lhashval2 : ULONG) : BOOL;
BEGIN
    RETURN (00ff0000h BAND lhashval1) = (00ff0000h BAND lhashval2);
END IsHashValCompatible;

END OOle2.
