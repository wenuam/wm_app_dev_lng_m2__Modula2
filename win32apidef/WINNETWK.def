(*
* Copyright (c) 1985-2000, Microsoft Corp. All rights reserved.             *
*)
(* Conversion from Microsoft WIN32 SDK C source to Modula-2 source *)
(* Copyright (c) 2009, ADW Software. All rights reserved. *)

DEFINITION MODULE WINNETWK;

FROM WIN32 IMPORT
    DWORD, LPSTR, LPWSTR, BOOL, HANDLE, LPVOID, HWND, WORD, UINT, ULONG_PTR;

IMPORT WINERROR;

<*/CALLS:WINDOWSCALL/DLLDEF*>
<*/NOHIGH*>
<*/ALIGN:8/NOPACK*>

CONST
    WNNC_NET_MSNET              = 00010000h;
    WNNC_NET_LANMAN             = 00020000h;
    WNNC_NET_NETWARE            = 00030000h;
    WNNC_NET_VINES              = 00040000h;
    WNNC_NET_10NET              = 00050000h;
    WNNC_NET_LOCUS              = 00060000h;
    WNNC_NET_SUN_PC_NFS         = 00070000h;
    WNNC_NET_LANSTEP            = 00080000h;
    WNNC_NET_9TILES             = 00090000h;
    WNNC_NET_LANTASTIC          = 000A0000h;
    WNNC_NET_AS400              = 000B0000h;
    WNNC_NET_FTP_NFS            = 000C0000h;
    WNNC_NET_PATHWORKS          = 000D0000h;
    WNNC_NET_LIFENET            = 000E0000h;
    WNNC_NET_POWERLAN           = 000F0000h;
    WNNC_NET_BWNFS              = 00100000h;
    WNNC_NET_COGENT             = 00110000h;
    WNNC_NET_FARALLON           = 00120000h;
    WNNC_NET_APPLETALK          = 00130000h;
    WNNC_NET_INTERGRAPH         = 00140000h;
     WNNC_NET_SYMFONET   =00150000h;
     WNNC_NET_CLEARCASE  =00160000h;
     WNNC_NET_FRONTIER   =00170000h;
     WNNC_NET_BMC        =00180000h;
     WNNC_NET_DCE        =00190000h;
     WNNC_NET_DECORB     =00200000h;
     WNNC_NET_PROTSTOR   =00210000h;
     WNNC_NET_FJ_REDIR   =00220000h;
     WNNC_NET_DISTINCT   =00230000h;
     WNNC_NET_TWINS      =00240000h;
     WNNC_NET_RDR2SAMPLE =00250000h;

    WNNC_NET_CSC         = 00260000h;
    WNNC_NET_3IN1        = 00270000h;
    WNNC_NET_EXTENDNET   = 00290000h;
    WNNC_NET_OBJECT_DIRE = 00300000h;
    WNNC_NET_MASFAX      = 00310000h;
    WNNC_NET_HOB_NFS     = 00320000h;
    WNNC_NET_SHIVA       = 00330000h;
    WNNC_NET_IBMAL       = 00340000h;

    WNNC_CRED_MANAGER   =0FFFF0000h;

    RESOURCE_CONNECTED   = 000000001h;
    RESOURCE_GLOBALNET   = 000000002h;
    RESOURCE_REMEMBERED  = 000000003h;
    RESOURCETYPE_ANY     = 000000000h;

    RESOURCETYPE_DISK    = 000000001h;
    RESOURCETYPE_PRINT   = 000000002h;
    RESOURCETYPE_RECENT   = 000000004h;
    RESOURCETYPE_CONTEXT  = 000000005h;
    RESOURCETYPE_RESERVED = 000000008h;

    RESOURCETYPE_UNKNOWN        = 0FFFFFFFFh;

    RESOURCEUSAGE_CONNECTABLE   = 000000001h;
    RESOURCEUSAGE_CONTAINER     = 000000002h;


    RESOURCEUSAGE_NOLOCALDEVICE = 000000004h;
    RESOURCEUSAGE_SIBLING       = 000000008h;
    RESOURCEUSAGE_ATTACHED      = 00000010h;
    RESOURCEUSAGE_ALL           = (RESOURCEUSAGE_CONNECTABLE BOR
                                   RESOURCEUSAGE_CONTAINER);

    RESOURCEUSAGE_RESERVED      = 080000000h;

    RESOURCEDISPLAYTYPE_GENERIC = 000000000h;
    RESOURCEDISPLAYTYPE_DOMAIN  = 000000001h;
    RESOURCEDISPLAYTYPE_SERVER  = 000000002h;
    RESOURCEDISPLAYTYPE_SHARE   = 000000003h;
    RESOURCEDISPLAYTYPE_FILE    = 000000004h;
    RESOURCEDISPLAYTYPE_GROUP   = 000000005h;


    RESOURCEDISPLAYTYPE_NETWORK        = 00000006h;
    RESOURCEDISPLAYTYPE_ROOT           = 00000007h;
    RESOURCEDISPLAYTYPE_SHAREADMIN     = 00000008h;
    RESOURCEDISPLAYTYPE_DIRECTORY      = 00000009h;
    RESOURCEDISPLAYTYPE_TREE           = 0000000Ah;
    RESOURCEDISPLAYTYPE_NDSCONTAINER   = 0000000Bh;



TYPE
    NETRESOURCEA = RECORD
          dwScope        : DWORD;
          dwType         : DWORD;
          dwDisplayType  : DWORD;
          dwUsage        : DWORD;
          lpLocalName    : LPSTR;
          lpRemoteName   : LPSTR;
          lpComment      : LPSTR;
          lpProvider     : LPSTR;
    END;
    LPNETRESOURCEA       = POINTER TO NETRESOURCEA;

    NETRESOURCEW = RECORD
          dwScope        : DWORD;
          dwType         : DWORD;
          dwDisplayType  : DWORD;
          dwUsage        : DWORD;
          lpLocalName    : LPWSTR;
          lpRemoteName   : LPWSTR;
          lpComment      : LPWSTR;
          lpProvider     : LPWSTR;
    END;
    LPNETRESOURCEW       = POINTER TO NETRESOURCEW;

%IF UNICODE %THEN
    NETRESOURCE          = NETRESOURCEW;
    LPNETRESOURCE        = LPNETRESOURCEW;
%ELSE
    NETRESOURCE          = NETRESOURCEA;
    LPNETRESOURCE        = LPNETRESOURCEA;
%END

CONST
    CONNECT_UPDATE_PROFILE      = 00000001h;

    CONNECT_UPDATE_RECENT       = 00000002h;
    CONNECT_TEMPORARY           = 00000004h;
    CONNECT_INTERACTIVE         = 00000008h;
    CONNECT_PROMPT              = 00000010h;
    CONNECT_NEED_DRIVE          = 00000020h;
    CONNECT_REFCOUNT            = 00000040h;
    CONNECT_REDIRECT            = 00000080h;
    CONNECT_LOCALDRIVE          = 00000100h;
    CONNECT_CURRENT_MEDIA       = 00000200h;
    CONNECT_DEFERRED            = 00000400h;
    CONNECT_RESERVED            = 0FF000000h;
    NETPROPERTY_PERSISTENT      = 1;


PROCEDURE WNetAddConnectionA(lpRemoteName : ARRAY OF ACHAR;
                             lpPassword : ARRAY OF ACHAR;
                             lpLocalName : ARRAY OF ACHAR) : DWORD;

PROCEDURE WNetAddConnectionW(lpRemoteName : ARRAY OF UCHAR;
                             lpPassword : ARRAY OF UCHAR;
                             lpLocalName : ARRAY OF UCHAR) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetAddConnection = WNetAddConnectionW;
%ELSE
PROCEDURE WNetAddConnection = WNetAddConnectionA;
%END


PROCEDURE WNetAddConnection2A(lpNetResource : LPNETRESOURCEA;
                              lpPassword : ARRAY OF ACHAR;
                              lpUserName : ARRAY OF ACHAR;
                              dwFlags : DWORD) : DWORD;

PROCEDURE WNetAddConnection2W(lpNetResource : LPNETRESOURCEW;
                              lpPassword : ARRAY OF UCHAR;
                              lpUserName : ARRAY OF UCHAR;
                              dwFlags : DWORD) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetAddConnection2 = WNetAddConnection2W;
%ELSE
PROCEDURE WNetAddConnection2 = WNetAddConnection2A;
%END

PROCEDURE WNetAddConnection3A(hwndOwner : HWND;
                             lpNetResource : LPNETRESOURCEA;
                             lpPassword : ARRAY OF ACHAR;
                             lpUserName : ARRAY OF ACHAR;
                             dwFlags : DWORD) : DWORD;

PROCEDURE WNetAddConnection3W(hwndOwner : HWND;
                             lpNetResource : LPNETRESOURCEW;
                             lpPassword : ARRAY OF UCHAR;
                             lpUserName : ARRAY OF UCHAR;
                             dwFlags : DWORD) : DWORD;
%IF UNICODE %THEN
PROCEDURE WNetAddConnection3 = WNetAddConnection3W;
%ELSE
PROCEDURE WNetAddConnection3 = WNetAddConnection3A;
%END

PROCEDURE WNetCancelConnectionA(lpName : ARRAY OF ACHAR;
                                fForce : BOOL) : DWORD;

PROCEDURE WNetCancelConnectionW(lpName : ARRAY OF UCHAR;
                                fForce : BOOL) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetCancelConnection = WNetCancelConnectionW;
%ELSE
PROCEDURE WNetCancelConnection = WNetCancelConnectionA;
%END

PROCEDURE WNetCancelConnection2A(lpName : ARRAY OF ACHAR;
                                 dwFlags : DWORD;
                                 fForce : BOOL) : DWORD;

PROCEDURE WNetCancelConnection2W(lpName : ARRAY OF UCHAR;
                                 dwFlags : DWORD;
                                 fForce : BOOL) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetCancelConnection2 = WNetCancelConnection2W;
%ELSE
PROCEDURE WNetCancelConnection2 = WNetCancelConnection2A;
%END

PROCEDURE WNetGetConnectionA(lpLocalName : ARRAY OF ACHAR;
                             VAR lpRemoteName : ARRAY OF ACHAR;
                             VAR lpnLength : DWORD) : DWORD;

PROCEDURE WNetGetConnectionW(lpLocalName : ARRAY OF UCHAR;
                             VAR lpRemoteName : ARRAY OF UCHAR;
                             VAR lpnLength : DWORD) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetConnection = WNetGetConnectionW;
%ELSE
PROCEDURE WNetGetConnection = WNetGetConnectionA;
%END


PROCEDURE WNetRestoreSingleConnectionW(
        hwndParent : HWND;
        lpDevice : ARRAY OF UCHAR;
    fUseUI : BOOL
    ) : DWORD;


PROCEDURE WNetUseConnectionA(
        hwndOwner : HWND;
        VAR lpNetResource : NETRESOURCEA;
        lpUserID : ARRAY OF ACHAR;
        lpPassword : ARRAY OF ACHAR;
        dwFlags : DWORD;
        VAR lpAccessName : ARRAY OF ACHAR;
        VAR lpBufferSize : DWORD;
        VAR lpResult : DWORD
        ) : DWORD;

PROCEDURE WNetUseConnectionW(
        hwndOwner : HWND;
        VAR lpNetResource : NETRESOURCEW;
        lpUserID : ARRAY OF UCHAR;
        lpPassword : ARRAY OF UCHAR;
        dwFlags : DWORD;
        VAR lpAccessName : ARRAY OF UCHAR;
        VAR lpBufferSize : DWORD;
        VAR lpResult : DWORD
        ) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetUseConnection = WNetUseConnectionW;
%ELSE
PROCEDURE WNetUseConnection = WNetUseConnectionA;
%END

PROCEDURE WNetSetConnectionA(
                            lpName : ARRAY OF ACHAR;
                            dwProperties : DWORD;
                            pvValues : LPVOID
                            ) : DWORD;

PROCEDURE WNetSetConnectionW(
                            lpName : ARRAY OF UCHAR;
                            dwProperties : DWORD;
                            pvValues : LPVOID
                            ) : DWORD;
%IF UNICODE %THEN
PROCEDURE WNetSetConnection = WNetSetConnectionW;
%ELSE
PROCEDURE WNetSetConnection = WNetSetConnectionA;
%END


PROCEDURE WNetOpenEnumA(dwScope : DWORD;
                        dwType : DWORD;
                        dwUsage : DWORD;
                        lpNetResource : LPNETRESOURCEA;
                        VAR lphEnum : HANDLE) : DWORD;

PROCEDURE WNetOpenEnumW(dwScope : DWORD;
                        dwType : DWORD;
                        dwUsage : DWORD;
                        lpNetResource : LPNETRESOURCEW;
                        VAR lphEnum : HANDLE) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetOpenEnum = WNetOpenEnumW;
%ELSE
PROCEDURE WNetOpenEnum = WNetOpenEnumA;
%END

PROCEDURE WNetEnumResourceA(hEnum : HANDLE;
                            VAR lpcCount : DWORD;
                            lpBuffer : LPVOID;
                            VAR lpBufferSize : DWORD) : DWORD;

PROCEDURE WNetEnumResourceW(hEnum : HANDLE;
                            VAR lpcCount : DWORD;
                            lpBuffer : LPVOID;
                            VAR lpBufferSize : DWORD) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetEnumResource = WNetEnumResourceW;
%ELSE
PROCEDURE WNetEnumResource = WNetEnumResourceA;
%END

PROCEDURE WNetCloseEnum(hEnum : HANDLE) : DWORD;

PROCEDURE WNetGetResourceParentA(
    lpNetResource : LPNETRESOURCEA;
    lpBuffer : LPVOID;
    VAR lpcbBuffer : DWORD
    ) : DWORD;

PROCEDURE WNetGetResourceParentW(
    lpNetResource : LPNETRESOURCEW;
    lpBuffer : LPVOID;
    VAR lpcbBuffer : DWORD
    ) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetResourceParent = WNetGetResourceParentW;
%ELSE
PROCEDURE WNetGetResourceParent = WNetGetResourceParentA;
%END

PROCEDURE WNetGetResourceInformationA(
    lpNetResource : LPNETRESOURCEA;
    lpBuffer : LPVOID;
    VAR lpcbBuffer : DWORD;
    VAR lplpSystem : LPSTR
    ) : DWORD;

PROCEDURE WNetGetResourceInformationW(
    lpNetResource : LPNETRESOURCEW;
    lpBuffer : LPVOID;
    VAR lpcbBuffer : DWORD;
    VAR lplpSystem : LPWSTR
    ) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetResourceInformation = WNetGetResourceInformationW;
%ELSE
PROCEDURE WNetGetResourceInformation = WNetGetResourceInformationA;
%END

CONST
    UNIVERSAL_NAME_INFO_LEVEL   = 1;
    REMOTE_NAME_INFO_LEVEL      = 2;

TYPE
    UNIVERSAL_NAME_INFOA = RECORD
        lpUniversalName : LPSTR;
    END;
    LPUNIVERSAL_NAME_INFOA      = POINTER TO UNIVERSAL_NAME_INFOA;

    UNIVERSAL_NAME_INFOW = RECORD
        lpUniversalName : LPWSTR;
    END;
    LPUNIVERSAL_NAME_INFOW      = POINTER TO UNIVERSAL_NAME_INFOW;
%IF UNICODE %THEN
    UNIVERSAL_NAME_INFO         = UNIVERSAL_NAME_INFOW;
    LPUNIVERSAL_NAME_INFO       = LPUNIVERSAL_NAME_INFOW;
%ELSE
    UNIVERSAL_NAME_INFO         = UNIVERSAL_NAME_INFOA;
    LPUNIVERSAL_NAME_INFO       = LPUNIVERSAL_NAME_INFOA;
%END

    REMOTE_NAME_INFOA = RECORD
        lpUniversalName         : LPSTR;
        lpConnectionName        : LPSTR;
        lpRemainingPath         : LPSTR;
    END;
    LPREMOTE_NAME_INFOA         = POINTER TO REMOTE_NAME_INFOA;

    REMOTE_NAME_INFOW = RECORD
        lpUniversalName         : LPWSTR;
        lpConnectionName        : LPWSTR;
        lpRemainingPath         : LPWSTR;
    END;
    LPREMOTE_NAME_INFOW         = POINTER TO REMOTE_NAME_INFOW;
%IF UNICODE %THEN
    REMOTE_NAME_INFO    = REMOTE_NAME_INFOW;
    LPREMOTE_NAME_INFO  = LPREMOTE_NAME_INFOW;
%ELSE
    REMOTE_NAME_INFO    = REMOTE_NAME_INFOA;
    LPREMOTE_NAME_INFO  = LPREMOTE_NAME_INFOA;
%END

PROCEDURE WNetGetUniversalNameA(lpLocalPath : ARRAY OF ACHAR;
                                 dwInfoLevel : DWORD;
                                 lpBuffer : LPVOID;
                                 VAR lpBufferSize : DWORD) : DWORD;

PROCEDURE WNetGetUniversalNameW(lpLocalPath : ARRAY OF UCHAR;
                                 dwInfoLevel : DWORD;
                                 lpBuffer : LPVOID;
                                 VAR lpBufferSize : DWORD) : DWORD;
%IF UNICODE %THEN
PROCEDURE WNetGetUniversalName = WNetGetUniversalNameW;
%ELSE
PROCEDURE WNetGetUniversalName = WNetGetUniversalNameA;
%END

PROCEDURE WNetGetUserA(lpName : ARRAY OF ACHAR;
                       VAR lpUserName : ARRAY OF ACHAR;
                       VAR lpnLength : DWORD) : DWORD;

PROCEDURE WNetGetUserW(lpName : ARRAY OF UCHAR;
                       VAR lpUserName : ARRAY OF UCHAR;
                       VAR lpnLength : DWORD) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetUser = WNetGetUserW;
%ELSE
PROCEDURE WNetGetUser = WNetGetUserA;
%END

CONST

    LOGON_DONE              = 00000001h;
    LOGON_PRIMARY           = 00000002h;
    LOGON_MUST_VALIDATE     = 00000004h;

    LOGOFF_PENDING          = 1;
    LOGOFF_COMMIT           = 2;
    LOGOFF_CANCEL           = 3;

    WNFMT_MULTILINE         = 1h;
    WNFMT_ABBREVIATED       = 2h;
    WNFMT_INENUM            = 10h;
    WNFMT_CONNECTION        = 20h;

PROCEDURE WNetGetProviderNameA(
                                dwNetType : DWORD;
                                VAR lpProviderName : ARRAY OF ACHAR;
                                VAR lpBufferSize : DWORD
                                ) : DWORD;

PROCEDURE WNetGetProviderNameW(
                                dwNetType : DWORD;
                                VAR lpProviderName : ARRAY OF UCHAR;
                                VAR lpBufferSize : DWORD
                                ) : DWORD;
%IF UNICODE %THEN
PROCEDURE WNetGetProviderName = WNetGetProviderNameW;
%ELSE
PROCEDURE WNetGetProviderName = WNetGetProviderNameA;
%END

TYPE
    NETINFOSTRUCT = RECORD
        cbStructure             : DWORD;
        dwProviderVersion       : DWORD;
        dwStatus                : DWORD;
        dwCharacteristics       : DWORD;
        dwHandle                : ULONG_PTR;
        wNetType                : WORD;
        dwPrinters              : DWORD;
        dwDrives                : DWORD;
    END;
    LPNETINFOSTRUCT = POINTER TO NETINFOSTRUCT;

CONST
    NETINFO_DLL16       = 00000001h;
    NETINFO_DISKRED     = 00000004h;
    NETINFO_PRINTERRED  = 00000008h;

PROCEDURE WNetGetNetworkInformationA(
                                    lpProvider : ARRAY OF ACHAR;
                                    VAR lpNetInfoStruct : NETINFOSTRUCT
                                    ) : DWORD;

PROCEDURE WNetGetNetworkInformationW(
                                    lpProvider : ARRAY OF UCHAR;
                                    VAR lpNetInfoStruct : NETINFOSTRUCT
                                    ) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetNetworkInformation = WNetGetNetworkInformationW;
%ELSE
PROCEDURE WNetGetNetworkInformation = WNetGetNetworkInformationA;
%END

TYPE
    PFNGETPROFILEPATHA = PROCEDURE(ARRAY OF ACHAR,
                                   VAR ARRAY OF ACHAR,
                                   UINT) : UINT [CPASCAL];

    PFNGETPROFILEPATHW = PROCEDURE(ARRAY OF UCHAR,
                                   VAR ARRAY OF UCHAR,
                                   UINT) : UINT [CPASCAL];
%IF UNICODE %THEN
    PFNGETPROFILEPATH = PFNGETPROFILEPATHW;
%ELSE
    PFNGETPROFILEPATH = PFNGETPROFILEPATHA;
%END

    PFNRECONCILEPROFILEA = PROCEDURE(ARRAY OF ACHAR,
                                     ARRAY OF ACHAR,
                                     DWORD) : UINT [CPascal];

    PFNRECONCILEPROFILEW = PROCEDURE(ARRAY OF UCHAR,
                                     ARRAY OF UCHAR,
                                     DWORD) : UINT [CPascal];

%IF UNICODE %THEN
    PFNRECONCILEPROFILE = PFNRECONCILEPROFILEW;
%ELSE
    PFNRECONCILEPROFILE = PFNRECONCILEPROFILEA;
%END

CONST
    RP_LOGON    = 1h;
    RP_INIFILE  = 2h;

TYPE
    PFNPROCESSPOLICIESA = PROCEDURE(HWND,
                                    ARRAY OF ACHAR,
                                    ARRAY OF ACHAR,
                                    ARRAY OF ACHAR,
                                    DWORD) : BOOL;

    PFNPROCESSPOLICIESW = PROCEDURE(HWND,
                                    ARRAY OF UCHAR,
                                    ARRAY OF UCHAR,
                                    ARRAY OF UCHAR,
                                    DWORD) : BOOL;

%IF UNICODE %THEN
    PFNPROCESSPOLICIES  = PFNPROCESSPOLICIESW;
%ELSE
    PFNPROCESSPOLICIES  = PFNPROCESSPOLICIESA;
%END

CONST
    PP_DISPLAYERRORS    = 01h;



PROCEDURE WNetConnectionDialog(hwnd : HWND;
                               dwType : DWORD) : DWORD;

PROCEDURE WNetDisconnectDialog(hwnd : HWND;
                               dwType : DWORD) : DWORD;


TYPE
    CONNECTDLGSTRUCTA = RECORD
        cbStructure     : DWORD;
        hwndOwner       : HWND;
        lpConnRes       : LPNETRESOURCEA;
        dwFlags         : DWORD;
        dwDevNum        : DWORD;
    END;
    LPCONNECTDLGSTRUCTA = POINTER TO CONNECTDLGSTRUCTA;

    CONNECTDLGSTRUCTW = RECORD
        cbStructure     : DWORD;
        hwndOwner       : HWND;
        lpConnRes       : LPNETRESOURCEW;
        dwFlags         : DWORD;
        dwDevNum        : DWORD;
    END;
    LPCONNECTDLGSTRUCTW = POINTER TO CONNECTDLGSTRUCTW;

%IF UNICODE %THEN
    CONNECTDLGSTRUCT = CONNECTDLGSTRUCTW;
    LPCONNECTDLGSTRUCT = LPCONNECTDLGSTRUCTW;
%ELSE
    CONNECTDLGSTRUCT = CONNECTDLGSTRUCTA;
    LPCONNECTDLGSTRUCT = LPCONNECTDLGSTRUCTA;
%END

CONST
    CONNDLG_RO_PATH     = 00000001h;
    CONNDLG_CONN_POINT  = 00000002h;
    CONNDLG_USE_MRU     = 00000004h;
    CONNDLG_HIDE_BOX    = 00000008h;

    CONNDLG_PERSIST     = 00000010h;
    CONNDLG_NOT_PERSIST = 00000020h;

PROCEDURE WNetConnectionDialog1A(
                                VAR lpConnDlgStruct : CONNECTDLGSTRUCTA
                                );

PROCEDURE WNetConnectionDialog1W(
                                VAR lpConnDlgStruct : CONNECTDLGSTRUCTW
                                );
%IF UNICODE %THEN
PROCEDURE WNetConnectionDialog1 = WNetConnectionDialog1W;
%ELSE
PROCEDURE WNetConnectionDialog1 = WNetConnectionDialog1A;
%END

TYPE
    DISCDLGSTRUCTA = RECORD
        cbStructure     : DWORD;
        hwndOwner       : HWND;
        lpLocalName     : LPSTR;
        lpRemoteName    : LPSTR;
        dwFlags         : DWORD;
    END;
    LPDISCDLGSTRUCTA = POINTER TO DISCDLGSTRUCTA;

    DISCDLGSTRUCTW = RECORD
        cbStructure     : DWORD;
        hwndOwner       : HWND;
        lpLocalName     : LPWSTR;
        lpRemoteName    : LPWSTR;
        dwFlags         : DWORD;
    END;
    LPDISCDLGSTRUCTW = POINTER TO DISCDLGSTRUCTW;

%IF UNICODE %THEN
    DISCDLGSTRUCT = DISCDLGSTRUCTW;
    LPDISCDLGSTRUCT = LPDISCDLGSTRUCTW;
%ELSE
    DISCDLGSTRUCT = DISCDLGSTRUCTA;
    LPDISCDLGSTRUCT = LPDISCDLGSTRUCTA;
%END

CONST
    DISC_UPDATE_PROFILE         = 00000001h;
    DISC_NO_FORCE               = 00000040h;

PROCEDURE WNetDisconnectDialog1A(
                                VAR lpConnDlgStruct : DISCDLGSTRUCTA
                                ) : DWORD;

PROCEDURE WNetDisconnectDialog1W(
                                VAR lpConnDlgStruct : DISCDLGSTRUCTW
                                ) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetDisconnectDialog1 = WNetDisconnectDialog1W;
%ELSE
PROCEDURE WNetDisconnectDialog1 = WNetDisconnectDialog1A;
%END


PROCEDURE WNetGetLastErrorA(VAR lpError : DWORD;
                            VAR lpErrorBuf : ARRAY OF ACHAR;
                            nErrorBufSize : DWORD;
                            VAR lpNameBuf : ARRAY OF ACHAR;
                            nNameBufSize : DWORD) : DWORD;

PROCEDURE WNetGetLastErrorW(VAR lpError : DWORD;
                            VAR lpErrorBuf : ARRAY OF UCHAR;
                            nErrorBufSize : DWORD;
                            VAR lpNameBuf : ARRAY OF UCHAR;
                            nNameBufSize : DWORD) : DWORD;

%IF UNICODE %THEN
PROCEDURE WNetGetLastError = WNetGetLastErrorW;
%ELSE
PROCEDURE WNetGetLastError = WNetGetLastErrorA;
%END


CONST
    WN_SUCCESS              = WINERROR.NO_ERROR;
    WN_NO_ERROR             = WINERROR.NO_ERROR;
    WN_NOT_SUPPORTED        = WINERROR.ERROR_NOT_SUPPORTED;
    WN_CANCEL               = WINERROR.ERROR_CANCELLED;
    WN_RETRY                = WINERROR.ERROR_RETRY;
    WN_NET_ERROR            = WINERROR.ERROR_UNEXP_NET_ERR;
    WN_MORE_DATA            = WINERROR.ERROR_MORE_DATA;
    WN_BAD_POINTER          = WINERROR.ERROR_INVALID_ADDRESS;
    WN_BAD_VALUE            = WINERROR.ERROR_INVALID_PARAMETER;
    WN_BAD_USER             = WINERROR.ERROR_BAD_USERNAME;
    WN_BAD_PASSWORD         = WINERROR.ERROR_INVALID_PASSWORD;
    WN_ACCESS_DENIED        = WINERROR.ERROR_ACCESS_DENIED;
    WN_FUNCTION_BUSY        = WINERROR.ERROR_BUSY;
    WN_WINDOWS_ERROR        = WINERROR.ERROR_UNEXP_NET_ERR;
    WN_OUT_OF_MEMORY        = WINERROR.ERROR_NOT_ENOUGH_MEMORY;
    WN_NO_NETWORK           = WINERROR.ERROR_NO_NETWORK;
    WN_EXTENDED_ERROR       = WINERROR.ERROR_EXTENDED_ERROR;
    WN_BAD_LEVEL            = WINERROR.ERROR_INVALID_LEVEL;
    WN_BAD_HANDLE           = WINERROR.ERROR_INVALID_HANDLE;
    WN_NOT_INITIALIZING     = WINERROR.ERROR_ALREADY_INITIALIZED;
    WN_NO_MORE_DEVICES      = WINERROR.ERROR_NO_MORE_DEVICES;

    WN_NOT_CONNECTED        = WINERROR.ERROR_NOT_CONNECTED;
    WN_OPEN_FILES           = WINERROR.ERROR_OPEN_FILES;
    WN_DEVICE_IN_USE        = WINERROR.ERROR_DEVICE_IN_USE;
    WN_BAD_NETNAME          = WINERROR.ERROR_BAD_NET_NAME;
    WN_BAD_LOCALNAME        = WINERROR.ERROR_BAD_DEVICE;
    WN_ALREADY_CONNECTED    = WINERROR.ERROR_ALREADY_ASSIGNED;
    WN_DEVICE_ERROR         = WINERROR.ERROR_GEN_FAILURE;
    WN_CONNECTION_CLOSED    = WINERROR.ERROR_CONNECTION_UNAVAIL;
    WN_NO_NET_OR_BAD_PATH   = WINERROR.ERROR_NO_NET_OR_BAD_PATH;
    WN_BAD_PROVIDER         = WINERROR.ERROR_BAD_PROVIDER;
    WN_CANNOT_OPEN_PROFILE  = WINERROR.ERROR_CANNOT_OPEN_PROFILE;
    WN_BAD_PROFILE          = WINERROR.ERROR_BAD_PROFILE;
    WN_BAD_DEV_TYPE         = WINERROR.ERROR_BAD_DEV_TYPE;
    WN_DEVICE_ALREADY_REMEMBERED    = WINERROR.ERROR_DEVICE_ALREADY_REMEMBERED;
    WN_CONNECTED_OTHER_PASSWORD     = WINERROR.ERROR_CONNECTED_OTHER_PASSWORD;

    WN_NO_MORE_ENTRIES      = WINERROR.ERROR_NO_MORE_ITEMS;
    WN_NOT_CONTAINER        = WINERROR.ERROR_NOT_CONTAINER;

    WN_NOT_AUTHENTICATED    = WINERROR.ERROR_NOT_AUTHENTICATED;
    WN_NOT_LOGGED_ON        = WINERROR.ERROR_NOT_LOGGED_ON;
    WN_NOT_VALIDATED        = WINERROR.ERROR_NO_LOGON_SERVERS;

TYPE
    NETCONNECTINFOSTRUCT = RECORD
        cbStructure     : DWORD;
        dwFlags         : DWORD;
        dwSpeed         : DWORD;
        dwDelay         : DWORD;
        dwOptDataSize   : DWORD;
    END;
    LPNETCONNECTINFOSTRUCT = POINTER TO LPNETCONNECTINFOSTRUCT;

CONST
    WNCON_FORNETCARD        = 000000001h;
    WNCON_NOTROUTED         = 000000002h;
    WNCON_SLOWLINK          = 000000004h;
    WNCON_DYNAMIC           = 000000008h;

PROCEDURE MultinetGetConnectionPerformanceA(lpNetResource : LPNETRESOURCEA;
                                            lpNetConnectInfoStruct : LPNETCONNECTINFOSTRUCT
                                            ) : DWORD;

PROCEDURE MultinetGetConnectionPerformanceW(lpNetResource : LPNETRESOURCEW;
                                            lpNetConnectInfoStruct : LPNETCONNECTINFOSTRUCT
                                            ) : DWORD;

%IF UNICODE %THEN
PROCEDURE MultinetGetConnectionPerformance = MultinetGetConnectionPerformanceW;
%ELSE
PROCEDURE MultinetGetConnectionPerformance = MultinetGetConnectionPerformanceA;
%END

END WINNETWK.
