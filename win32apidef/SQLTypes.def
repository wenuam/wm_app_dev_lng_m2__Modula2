DEFINITION MODULE SQLTypes;

(*
This module contains definitions gotten from Microsoft module sqltypes.h

/********************************************************
*                                                       *
*   Copyright (C) Microsoft. All rights reserved.       *
*                                                       *
********************************************************/

//-----------------------------------------------------------------------------
// File:            sqltypes.h
//
// Contents:        This file defines the types used in ODBC
//
//-----------------------------------------------------------------------------
*)

FROM SYSTEM IMPORT ADDRESS;

FROM WIN32 IMPORT GUID, HWND;

<*/ALIGN:8/NOPACK*>

TYPE
(* API declaration data types *)
    SQLNUMERIC      = CARDINAL8;
    SQLPOINTER      = ADDRESS;
    SQLREAL         = REAL;
    SQLSMALLINT     = INTEGER16;
    SQLUSMALLINT    = CARDINAL16;
    SQLTIME         = CARDINAL8;
    SQLTIMESTAMP    = CARDINAL8;
    SQLVARCHAR      = CARDINAL8;

    SQLCHAR         = ACHAR;
    SQLSCHAR        = INTEGER8;
    SQLDATE         = INTEGER8;
    SQLDECIMAL      = INTEGER8;
    SQLDOUBLE       = LONGREAL;
    SQLFLOAT        = LONGREAL;
    SQLINTEGER      = INTEGER32;
    SQLUINTEGER     = CARDINAL32;
    <*IF Bits64 THEN*>
    SQLLEN          = INTEGER64;
    SQLULEN         = CARDINAL64;
    SQLSETPOSIROW   = CARDINAL64;
    <*ELSE*>
    SQLLEN          = SQLINTEGER;
    SQLULEN         = SQLUINTEGER;
    SQLSETPOSIROW   = SQLUSMALLINT;
    <*END*>

(* function return type *)
    SQLRETURN       = SQLSMALLINT;

(* generic data structures *)
    SQLHANDLE       = ADDRESS;
    SQLHENV         = SQLHANDLE;
    SQLHDBC         = SQLHANDLE;
    SQLHSTMT        = SQLHANDLE;
    SQLHDESC        = SQLHANDLE;

(* SQL portable types for C *)
    RETCODE = INTEGER16;
    SQLHWND = HWND;

(* transfer types for DATE, TIME, TIMESTAMP *)
    DATE_STRUCT =
        RECORD
            year  : SQLSMALLINT;
            month : SQLUSMALLINT;
            day   : SQLUSMALLINT;
        END;

    SQL_DATE_STRUCT = DATE_STRUCT;

    TIME_STRUCT =
        RECORD
            hour   : SQLUSMALLINT;
            minute : SQLUSMALLINT;
            second : SQLUSMALLINT;
        END;

    SQL_TIME_STRUCT = TIME_STRUCT;

    TIMESTAMP_STRUCT =
        RECORD
            year     : SQLSMALLINT;
            month    : SQLUSMALLINT;
            day      : SQLUSMALLINT;
            hour     : SQLUSMALLINT;
            minute   : SQLUSMALLINT;
            second   : SQLUSMALLINT;
            fraction : SQLUINTEGER;
        END;

        SQL_TIMESTAMP = TIMESTAMP_STRUCT;

(*
 * enumerations for DATETIME_INTERVAL_SUBCODE values for interval data types
 * these values are from SQL-92
 *)
    SQLINTERVAL =
        (
            SQL_IS_YEAR             =  1,
            SQL_IS_MONTH            =  2,
            SQL_IS_DAY              =  3,
            SQL_IS_HOUR             =  4,
            SQL_IS_MINUTE           =  5,
            SQL_IS_SECOND           =  6,
            SQL_IS_YEAR_TO_MONTH    =  7,
            SQL_IS_DAY_TO_HOUR      =  8,
            SQL_IS_DAY_TO_MINUTE    =  9,
            SQL_IS_DAY_TO_SECOND    = 10,
            SQL_IS_HOUR_TO_MINUTE   = 11,
            SQL_IS_HOUR_TO_SECOND   = 12,
            SQL_IS_MINUTE_TO_SECOND = 13
        ) BIG;

    SQL_YEAR_MONTH_STRUCT =
        RECORD
            year  : SQLUINTEGER;
            month : SQLUINTEGER;
        END;

    SQL_DAY_SECOND_STRUCT =
        RECORD
            day      : SQLUINTEGER;
            hour     : SQLUINTEGER;
            minute   : SQLUINTEGER;
            second   : SQLUINTEGER;
            fraction : SQLUINTEGER;
        END;

    SQL_INTERVAL_STRUCT =
        RECORD
            interval_type : SQLINTERVAL;
            interval_sign : SQLSMALLINT;
            intval :
                RECORD
                    CASE : BOOLEAN OF
                    | FALSE : year_month : SQL_YEAR_MONTH_STRUCT;
                    | TRUE  : day_second : SQL_DAY_SECOND_STRUCT;
                    END;
                END;
        END;

(* internal representation of numeric data type *)
CONST
    SQL_MAX_NUMERIC_LEN = 16;

TYPE
    SQL_NUMERIC_STRUCT =
        RECORD
            precision : SQLCHAR;
            scale     : SQLSCHAR;
            sign      : SQLCHAR;
            val       : ARRAY [0..SQL_MAX_NUMERIC_LEN-1] OF SQLCHAR;
        END;

    SQLGUID = GUID;

    BOOKMARK = SQLULEN;

    SQLWCHAR = UCHAR;

    <*IF UNICODE THEN*>
    SQLTCHAR = SQLWCHAR;
    <*ELSE*>
    SQLTCHAR = SQLCHAR;
    <*END*>

END SQLTypes.
