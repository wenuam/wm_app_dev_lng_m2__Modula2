(*
* Copyright (c) 1985-2000, Microsoft Corp. All rights reserved.             *
*)
(* Conversion from Microsoft WIN32 SDK C source to Modula-2 source *)
(* Copyright (c) 2009, ADW Software. All rights reserved. *)

UNSAFEGUARDED DEFINITION MODULE OleDlg;

FROM WIN32 IMPORT
    HWND, WINT, UINT, WPARAM, LPARAM, BOOL, HMENU, DWORD,
    LPCSTR, LPCWSTR, HINSTANCE, HRSRC, LPCLSID, CLSID, LPSTR, LPWSTR,
    IID, HGLOBAL, SCODE, SIZEL, LPVOID, HRESULT, ULONG,
    MAX_PATH, WORD, REFCLSID, HTASK, FILETIME;

FROM OOle2 IMPORT
    IOleObject, LPFORMATETC, IOleClientSite, IStorage, FORMATETC,
    IDataObject, IUnknown;

FROM COMMDLG IMPORT
    OPENFILENAMEA, OPENFILENAMEW;

FROM COMMCTRL IMPORT
    LPPROPSHEETHEADERW, LPPROPSHEETHEADERA;

(*MVN+*)
<*/Foreign*>
(*MVN-*)
<*/CALLS:WINDOWSCALL/DLLDEF*>
<*/NOHIGH*>
<*/ALIGN:8*>
<*/NOPACK*>
CONST
    IDC_OLEUIHELP                   = 99;

    IDC_IO_CREATENEW                = 2100;
    IDC_IO_CREATEFROMFILE           = 2101;
    IDC_IO_LINKFILE                 = 2102;
    IDC_IO_OBJECTTYPELIST           = 2103;
    IDC_IO_DISPLAYASICON            = 2104;
    IDC_IO_CHANGEICON               = 2105;
    IDC_IO_FILE                     = 2106;
    IDC_IO_FILEDISPLAY              = 2107;
    IDC_IO_RESULTIMAGE              = 2108;
    IDC_IO_RESULTTEXT               = 2109;
    IDC_IO_ICONDISPLAY              = 2110;
    IDC_IO_OBJECTTYPETEXT           = 2111;
    IDC_IO_FILETEXT                 = 2112;
    IDC_IO_FILETYPE                 = 2113;
    IDC_IO_INSERTCONTROL            = 2114;
    IDC_IO_ADDCONTROL               = 2115;
    IDC_IO_CONTROLTYPELIST          = 2116;

    IDC_PS_PASTE                    = 500;
    IDC_PS_PASTELINK                = 501;
    IDC_PS_SOURCETEXT               = 502;
    IDC_PS_PASTELIST                = 503;
    IDC_PS_PASTELINKLIST            = 504;
    IDC_PS_DISPLAYLIST              = 505;
    IDC_PS_DISPLAYASICON            = 506;
    IDC_PS_ICONDISPLAY              = 507;
    IDC_PS_CHANGEICON               = 508;
    IDC_PS_RESULTIMAGE              = 509;
    IDC_PS_RESULTTEXT               = 510;

    IDC_CI_GROUP                    = 120;
    IDC_CI_CURRENT                  = 121;
    IDC_CI_CURRENTICON              = 122;
    IDC_CI_DEFAULT                  = 123;
    IDC_CI_DEFAULTICON              = 124;
    IDC_CI_FROMFILE                 = 125;
    IDC_CI_FROMFILEEDIT             = 126;
    IDC_CI_ICONLIST                 = 127;
    IDC_CI_LABEL                    = 128;
    IDC_CI_LABELEDIT                = 129;
    IDC_CI_BROWSE                   = 130;
    IDC_CI_ICONDISPLAY              = 131;

    IDC_CV_OBJECTTYPE               = 150;
    IDC_CV_DISPLAYASICON            = 152;
    IDC_CV_CHANGEICON               = 153;
    IDC_CV_ACTIVATELIST             = 154;
    IDC_CV_CONVERTTO                = 155;
    IDC_CV_ACTIVATEAS               = 156;
    IDC_CV_RESULTTEXT               = 157;
    IDC_CV_CONVERTLIST              = 158;
    IDC_CV_ICONDISPLAY              = 165;

    IDC_EL_CHANGESOURCE             = 201;
    IDC_EL_AUTOMATIC                = 202;
    IDC_EL_CANCELLINK               = 209;
    IDC_EL_UPDATENOW                = 210;
    IDC_EL_OPENSOURCE               = 211;
    IDC_EL_MANUAL                   = 212;
    IDC_EL_LINKSOURCE               = 216;
    IDC_EL_LINKTYPE                 = 217;
    IDC_EL_LINKSLISTBOX             = 206;
    IDC_EL_COL1                     = 220;
    IDC_EL_COL2                     = 221;
    IDC_EL_COL3                     = 222;

    IDC_BZ_RETRY                    = 600;
    IDC_BZ_ICON                     = 601;
    IDC_BZ_MESSAGE1                 = 602;
    IDC_BZ_SWITCHTO                 = 604;

    IDC_UL_METER                    = 1029;
    IDC_UL_STOP                     = 1030;
    IDC_UL_PERCENT                  = 1031;
    IDC_UL_PROGRESS                 = 1032;

    IDC_PU_LINKS                    = 900;
    IDC_PU_TEXT                     = 901;
    IDC_PU_CONVERT                  = 902;
    IDC_PU_ICON                     = 908;

    IDC_GP_OBJECTNAME               = 1009;
    IDC_GP_OBJECTTYPE               = 1010;
    IDC_GP_OBJECTSIZE               = 1011;
    IDC_GP_CONVERT                  = 1013;
    IDC_GP_OBJECTICON               = 1014;
    IDC_GP_OBJECTLOCATION           = 1022;

    IDC_VP_PERCENT                  = 1000;
    IDC_VP_CHANGEICON               = 1001;
    IDC_VP_EDITABLE                 = 1002;
    IDC_VP_ASICON                   = 1003;
    IDC_VP_RELATIVE                 = 1005;
    IDC_VP_SPIN                     = 1006;
    IDC_VP_SCALETXT                 = 1034;
    IDC_VP_ICONDISPLAY              = 1021;
    IDC_VP_RESULTIMAGE              = 1033;

    IDC_LP_OPENSOURCE               = 1006;
    IDC_LP_UPDATENOW                = 1007;
    IDC_LP_BREAKLINK                = 1008;
    IDC_LP_LINKSOURCE               = 1012;
    IDC_LP_CHANGESOURCE             = 1015;
    IDC_LP_AUTOMATIC                = 1016;
    IDC_LP_MANUAL                   = 1017;
    IDC_LP_DATE                     = 1018;
    IDC_LP_TIME                     = 1019;

    IDD_INSERTOBJECT                = 1000;
    IDD_CHANGEICON                  = 1001;
    IDD_CONVERT                     = 1002;
    IDD_PASTESPECIAL                = 1003;
    IDD_EDITLINKS                   = 1004;
    IDD_BUSY                        = 1006;
    IDD_UPDATELINKS                 = 1007;
    IDD_CHANGESOURCE                = 1009;
    IDD_INSERTFILEBROWSE            = 1010;
    IDD_CHANGEICONBROWSE            = 1011;
    IDD_CONVERTONLY                 = 1012;
    IDD_CHANGESOURCE4               = 1013;
    IDD_GNRLPROPS                   = 1100;
    IDD_VIEWPROPS                   = 1101;
    IDD_LINKPROPS                   = 1102;

    IDD_CANNOTUPDATELINK            = 1008;
    IDD_LINKSOURCEUNAVAILABLE       = 1020;
    IDD_SERVERNOTFOUND              = 1023;
    IDD_OUTOFMEMORY                 = 1024;
    IDD_SERVERNOTREGW               = 1021;
    IDD_LINKTYPECHANGEDW            = 1022;
    IDD_SERVERNOTREGA               = 1025;
    IDD_LINKTYPECHANGEDA            = 1026;
%IF UNICODE %THEN
    IDD_SERVERNOTREG                = IDD_SERVERNOTREGW;
    IDD_LINKTYPECHANGED             = IDD_LINKTYPECHANGEDW;
%ELSE
    IDD_SERVERNOTREG                = IDD_SERVERNOTREGA;
    IDD_LINKTYPECHANGED             = IDD_LINKTYPECHANGEDA;
%END
    OLESTDDELIM                     = "\\";

TYPE
    LPFNOLEUIHOOK = PROCEDURE(HWND, UINT, WPARAM, LPARAM) : UINT;

CONST
    SZOLEUI_MSG_HELP            = "OLEUI_MSG_HELP";
    SZOLEUI_MSG_ENDDIALOG       = "OLEUI_MSG_ENDDIALOG";
    SZOLEUI_MSG_BROWSE          = "OLEUI_MSG_BROWSE";
    SZOLEUI_MSG_CHANGEICON      = "OLEUI_MSG_CHANGEICON";
    SZOLEUI_MSG_CLOSEBUSYDIALOG = "OLEUI_MSG_CLOSEBUSYDIALOG";
    SZOLEUI_MSG_CONVERT         = "OLEUI_MSG_CONVERT";
    SZOLEUI_MSG_CHANGESOURCE    = "OLEUI_MSG_CHANGESOURCE";
    SZOLEUI_MSG_ADDCONTROL      = "OLEUI_MSG_ADDCONTROL";
    SZOLEUI_MSG_BROWSE_OFN      = "OLEUI_MSG_BROWSE_OFN";

    ID_BROWSE_CHANGEICON = 1;
    ID_BROWSE_INSERTFILE = 2;
    ID_BROWSE_ADDCONTROL = 3;
    ID_BROWSE_CHANGESOURCE= 4;

    OLEUI_FALSE          = 0;
    OLEUI_SUCCESS        = 1;
    OLEUI_OK             = 1;
    OLEUI_CANCEL         = 2;

    OLEUI_ERR_STANDARDMIN               = 100;
    OLEUI_ERR_STRUCTURENULL             = 101;
    OLEUI_ERR_STRUCTUREINVALID          = 102;
    OLEUI_ERR_CBSTRUCTINCORRECT         = 103;
    OLEUI_ERR_HWNDOWNERINVALID          = 104;
    OLEUI_ERR_LPSZCAPTIONINVALID        = 105;
    OLEUI_ERR_LPFNHOOKINVALID           = 106;
    OLEUI_ERR_HINSTANCEINVALID          = 107;
    OLEUI_ERR_LPSZTEMPLATEINVALID       = 108;
    OLEUI_ERR_HRESOURCEINVALID          = 109;

    OLEUI_ERR_FINDTEMPLATEFAILURE       = 110;
    OLEUI_ERR_LOADTEMPLATEFAILURE       = 111;
    OLEUI_ERR_DIALOGFAILURE             = 112;
    OLEUI_ERR_LOCALMEMALLOC             = 113;
    OLEUI_ERR_GLOBALMEMALLOC            = 114;
    OLEUI_ERR_LOADSTRING                = 115;
    OLEUI_ERR_OLEMEMALLOC               = 116;
    OLEUI_ERR_STANDARDMAX               = 117;

PROCEDURE OleUIAddVerbMenuW(lpOleObj : IOleObject;
                            lpszShortType : ARRAY OF UCHAR;
                            hMenu : HMENU;
                            uPos : UINT;
                            uIDVerbMin : UINT;
                            uIDVerbMax : UINT;
                            bAddConvert : BOOL;
                            idConvert : UINT;
                            VAR lphMenu : HMENU) : BOOL;

PROCEDURE OleUIAddVerbMenuA(lpOleObj : IOleObject;
                            lpszShortType : ARRAY OF ACHAR;
                            hMenu : HMENU;
                            uPos : UINT;
                            uIDVerbMin : UINT;
                            uIDVerbMax : UINT;
                            bAddConvert : BOOL;
                            idConvert : UINT;
                            VAR lphMenu : HMENU) : BOOL;
%IF UNICODE %THEN
PROCEDURE OleUIAddVerbMenu = OleUIAddVerbMenuW;
%ELSE
PROCEDURE OleUIAddVerbMenu = OleUIAddVerbMenuA;
%END

TYPE
    OLEUIINSERTOBJECTW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          clsid          : CLSID;
          lpszFile       : LPWSTR;
          cchFile        : UINT;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
          iid            : IID;
          oleRender      : DWORD;
          lpFormatEtc    : LPFORMATETC;
          lpIOleClientSite: IOleClientSite;
          lpIStorage     : IStorage;
          ppvObj         : POINTER TO LPVOID;
          sc             : SCODE;
          hMetaPict      : HGLOBAL;
    END;
    POLEUIINSERTOBJECTW  = POINTER TO OLEUIINSERTOBJECTW;
    LPOLEUIINSERTOBJECTW = POLEUIINSERTOBJECTW;

    OLEUIINSERTOBJECTA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          clsid          : CLSID;
          lpszFile       : LPSTR;
          cchFile        : UINT;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
          iid            : IID;
          oleRender      : DWORD;
          lpFormatEtc    : LPFORMATETC;
          lpIOleClientSite: IOleClientSite;
          lpIStorage     : IStorage;
          ppvObj         : POINTER TO LPVOID;
          sc             : SCODE;
          hMetaPict      : HGLOBAL;
    END;
    POLEUIINSERTOBJECTA  = POINTER TO OLEUIINSERTOBJECTA;
    LPOLEUIINSERTOBJECTA = POLEUIINSERTOBJECTA;

%IF UNICODE %THEN
    OLEUIINSERTOBJECT   = OLEUIINSERTOBJECTW;
    POLEUIINSERTOBJECT  = POLEUIINSERTOBJECTW;
    LPOLEUIINSERTOBJECT = LPOLEUIINSERTOBJECTW;
%ELSE
    OLEUIINSERTOBJECT   = OLEUIINSERTOBJECTA;
    POLEUIINSERTOBJECT  = POLEUIINSERTOBJECTA;
    LPOLEUIINSERTOBJECT = LPOLEUIINSERTOBJECTA;
%END

PROCEDURE OleUIInsertObjectW(a : LPOLEUIINSERTOBJECTW) : UINT;

PROCEDURE OleUIInsertObjectA(a : LPOLEUIINSERTOBJECTA) : UINT;

%IF UNICODE %THEN
PROCEDURE OleUIInsertObject = OleUIInsertObjectW;
%ELSE
PROCEDURE OleUIInsertObject = OleUIInsertObjectA;
%END

CONST
    IOF_SHOWHELP                = 000000001h;
    IOF_SELECTCREATENEW         = 000000002h;
    IOF_SELECTCREATEFROMFILE    = 000000004h;
    IOF_CHECKLINK               = 000000008h;
    IOF_CHECKDISPLAYASICON      = 000000010h;
    IOF_CREATENEWOBJECT         = 000000020h;
    IOF_CREATEFILEOBJECT        = 000000040h;
    IOF_CREATELINKOBJECT        = 000000080h;
    IOF_DISABLELINK             = 000000100h;
    IOF_VERIFYSERVERSEXIST      = 000000200h;
    IOF_DISABLEDISPLAYASICON    = 000000400h;
    IOF_HIDECHANGEICON          = 000000800h;
    IOF_SHOWINSERTCONTROL       = 000001000h;
    IOF_SELECTCREATECONTROL     = 000002000h;

    OLEUI_IOERR_LPSZFILEINVALID         = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_IOERR_LPSZLABELINVALID        = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_IOERR_HICONINVALID            = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_IOERR_LPFORMATETCINVALID      = OLEUI_ERR_STANDARDMAX + 3;
    OLEUI_IOERR_PPVOBJINVALID           = OLEUI_ERR_STANDARDMAX + 4;
    OLEUI_IOERR_LPIOLECLIENTSITEINVALID = OLEUI_ERR_STANDARDMAX + 5;
    OLEUI_IOERR_LPISTORAGEINVALID       = OLEUI_ERR_STANDARDMAX + 6;
    OLEUI_IOERR_SCODEHASERROR           = OLEUI_ERR_STANDARDMAX + 7;
    OLEUI_IOERR_LPCLSIDEXCLUDEINVALID   = OLEUI_ERR_STANDARDMAX + 8;
    OLEUI_IOERR_CCHFILEINVALID          = OLEUI_ERR_STANDARDMAX + 9;

TYPE
    OLEUIPASTEFLAG = DWORD;

CONST
    OLEUIPASTE_ENABLEICON    = 2048;
    OLEUIPASTE_PASTEONLY     = 0;
    OLEUIPASTE_PASTE         = 512;
    OLEUIPASTE_LINKANYTYPE   = 1024;
    OLEUIPASTE_LINKTYPE1     = 1;
    OLEUIPASTE_LINKTYPE2     = 2;
    OLEUIPASTE_LINKTYPE3     = 4;
    OLEUIPASTE_LINKTYPE4     = 8;
    OLEUIPASTE_LINKTYPE5     = 16;
    OLEUIPASTE_LINKTYPE6     = 32;
    OLEUIPASTE_LINKTYPE7     = 64;
    OLEUIPASTE_LINKTYPE8     = 128;

TYPE
    OLEUIPASTEENTRYW = RECORD
          fmtetc         : FORMATETC;
          lpstrFormatName: LPCWSTR;
          lpstrResultText: LPCWSTR;
          dwFlags        : DWORD;
          dwScratchSpace : DWORD;
    END;
    POLEUIPASTEENTRYW    = POINTER TO OLEUIPASTEENTRYW;
    LPOLEUIPASTEENTRYW   = POLEUIPASTEENTRYW;

    OLEUIPASTEENTRYA = RECORD
          fmtetc         : FORMATETC;
          lpstrFormatName: LPCSTR;
          lpstrResultText: LPCSTR;
          dwFlags        : DWORD;
          dwScratchSpace : DWORD;
    END;
    POLEUIPASTEENTRYA    = POINTER TO OLEUIPASTEENTRYA;
    LPOLEUIPASTEENTRYA   = POLEUIPASTEENTRYA;

%IF UNICODE %THEN
    OLEUIPASTEENTRY             = OLEUIPASTEENTRYW;
    POLEUIPASTEENTRY            = POLEUIPASTEENTRYW;
    LPOLEUIPASTEENTRY           = LPOLEUIPASTEENTRYW;
%ELSE
    OLEUIPASTEENTRY             = OLEUIPASTEENTRYA;
    POLEUIPASTEENTRY            = POLEUIPASTEENTRYA;
    LPOLEUIPASTEENTRY           = LPOLEUIPASTEENTRYA;
%END

CONST
    PS_MAXLINKTYPES      = 8;

TYPE
    OLEUIPASTESPECIALW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          lpSrcDataObj   : IDataObject;
          arrPasteEntries: LPOLEUIPASTEENTRYW;
          cPasteEntries  : WINT;
          arrLinkTypes   : POINTER TO UINT;
          cLinkTypes     : WINT;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
          nSelectedIndex : WINT;
          fLink          : BOOL;
          hMetaPict      : HGLOBAL;
          sizel          : SIZEL;
    END;
    POLEUIPASTESPECIALW  = POINTER TO OLEUIPASTESPECIALW;
    LPOLEUIPASTESPECIALW = POLEUIPASTESPECIALW;

    OLEUIPASTESPECIALA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          lpSrcDataObj   : IDataObject;
          arrPasteEntries: LPOLEUIPASTEENTRYA;
          cPasteEntries  : WINT;
          arrLinkTypes   : POINTER TO UINT;
          cLinkTypes     : WINT;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
          nSelectedIndex : WINT;
          fLink          : BOOL;
          hMetaPict      : HGLOBAL;
          sizel          : SIZEL;
    END;
    POLEUIPASTESPECIALA  = POINTER TO OLEUIPASTESPECIALA;
    LPOLEUIPASTESPECIALA = POLEUIPASTESPECIALA;

PROCEDURE OleUIPasteSpecialW(a : LPOLEUIPASTESPECIALW) : UINT;

PROCEDURE OleUIPasteSpecialA(a : LPOLEUIPASTESPECIALA) : UINT;

%IF UNICODE %THEN
TYPE
    OLEUIPASTESPECIAL           = OLEUIPASTESPECIALW;
    POLEUIPASTESPECIAL          = POLEUIPASTESPECIALW;
    LPOLEUIPASTESPECIAL         = LPOLEUIPASTESPECIALW;

PROCEDURE OleUIPasteSpecial = OleUIPasteSpecialW;
%ELSE
TYPE
    OLEUIPASTESPECIAL           = OLEUIPASTESPECIALA;
    POLEUIPASTESPECIAL          = POLEUIPASTESPECIALA;
    LPOLEUIPASTESPECIAL         = LPOLEUIPASTESPECIALA;

PROCEDURE OleUIPasteSpecial = OleUIPasteSpecialA;
%END

CONST
    PSF_SHOWHELP                = 000000001h;
    PSF_SELECTPASTE             = 000000002h;
    PSF_SELECTPASTELINK         = 000000004h;
    PSF_CHECKDISPLAYASICON      = 000000008h;
    PSF_DISABLEDISPLAYASICON    = 000000010h;
    PSF_HIDECHANGEICON          = 000000020h;
    PSF_STAYONCLIPBOARDCHANGE   = 000000040h;
    PSF_NOREFRESHDATAOBJECT     = 000000080h;

    OLEUI_IOERR_SRCDATAOBJECTINVALID            = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_IOERR_ARRPASTEENTRIESINVALID          = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_IOERR_ARRLINKTYPESINVALID             = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_PSERR_CLIPBOARDCHANGED                = OLEUI_ERR_STANDARDMAX + 3;
    OLEUI_PSERR_GETCLIPBOARDFAILED              = OLEUI_ERR_STANDARDMAX + 4;

ABSTRACT CLASS IOleUILinkContainerW;
INHERIT IUnknown;
REVEAL GetNextLink, SetLinkUpdateOptions, GetLinkUpdateOptions,
       SetLinkSource, GetLinkSource, OpenLinkSource, UpdateLink, CancelLink;

ABSTRACT PROCEDURE GetNextLink(link : DWORD) : DWORD;

ABSTRACT PROCEDURE SetLinkUpdateOptions(link : DWORD;
                                        updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLinkUpdateOptions(link : DWORD;
                                        VAR updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE SetLinkSource(link : DWORD;
                                 displayName : ARRAY OF UCHAR;
                                 lenFileName : ULONG;
                                 VAR eaten : ULONG;
                                 validateSource : BOOL) : HRESULT;

ABSTRACT PROCEDURE GetLinkSource(link : DWORD;
                        VAR displayName : LPWSTR;
                        VAR lenDisplayName : ULONG;
                        VAR fullLinkType : LPWSTR;
                        VAR shortLinkType : LPWSTR;
                        VAR sourceAvailable : BOOL;
                        VAR isSelected : BOOL) : HRESULT;

ABSTRACT PROCEDURE OpenLinkSource(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE UpdateLink(link : DWORD;
                     errorMessage : BOOL;
                     reserved : BOOL) : HRESULT;

PROCEDURE CancelLink(link : DWORD) : HRESULT;

END IOleUILinkContainerW;

ABSTRACT CLASS IOleUILinkContainerA;
INHERIT IUnknown;
REVEAL GetNextLink, SetLinkUpdateOptions, GetLinkUpdateOptions,
       SetLinkSource, GetLinkSource, OpenLinkSource, UpdateLink, CancelLink;

ABSTRACT PROCEDURE GetNextLink(link : DWORD) : DWORD;

ABSTRACT PROCEDURE SetLinkUpdateOptions(link : DWORD;
                                        updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLinkUpdateOptions(link : DWORD;
                                        VAR updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE SetLinkSource(link : DWORD;
                                 displayName : ARRAY OF ACHAR;
                                 lenFileName : ULONG;
                                 VAR eaten : ULONG;
                                 validateSource : BOOL) : HRESULT;

ABSTRACT PROCEDURE GetLinkSource(link : DWORD;
                                 VAR displayName : LPSTR;
                                 VAR lenDisplayName : ULONG;
                                 VAR fullLinkType : LPSTR;
                                 VAR shortLinkType : LPSTR;
                                 VAR sourceAvailable : BOOL;
                                 VAR isSelected : BOOL) : HRESULT;

ABSTRACT PROCEDURE OpenLinkSource(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE UpdateLink(link : DWORD;
                              errorMessage : BOOL;
                              reserved : BOOL) : HRESULT;

ABSTRACT PROCEDURE CancelLink(link : DWORD) : HRESULT;

END IOleUILinkContainerA;

TYPE
%IF UNICODE %THEN
    IOleUILinkContainer         = IOleUILinkContainerW;
%ELSE
    IOleUILinkContainer         = IOleUILinkContainerA;
%END

    OLEUIEDITLINKSW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          lpOleUILinkContainer: IOleUILinkContainerW;
    END;
    POLEUIEDITLINKSW     = POINTER TO OLEUIEDITLINKSW;
    LPOLEUIEDITLINKSW    = POLEUIEDITLINKSW;

    OLEUIEDITLINKSA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          lpOleUILinkContainer: IOleUILinkContainerA;
    END;
    POLEUIEDITLINKSA     = POINTER TO OLEUIEDITLINKSA;
    LPOLEUIEDITLINKSA    = POLEUIEDITLINKSA;

%IF UNICODE %THEN
    OLEUIEDITLINKS      = OLEUIEDITLINKSW;
    POLEUIEDITLINKS     = POLEUIEDITLINKSW;
    LPOLEUIEDITLINKS    = LPOLEUIEDITLINKSW;
%ELSE
    OLEUIEDITLINKS      = OLEUIEDITLINKSA;
    POLEUIEDITLINKS     = POLEUIEDITLINKSA;
    LPOLEUIEDITLINKS    = LPOLEUIEDITLINKSA;
%END

CONST
    OLEUI_ELERR_LINKCNTRNULL    = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_ELERR_LINKCNTRINVALID = OLEUI_ERR_STANDARDMAX + 1;

PROCEDURE OleUIEditLinksW(a : LPOLEUIEDITLINKSW) : UINT;

PROCEDURE OleUIEditLinksA(a : LPOLEUIEDITLINKSA) : UINT;

%IF UNICODE %THEN
PROCEDURE OleUIEditLinks = OleUIEditLinksW;
%ELSE
PROCEDURE OleUIEditLinks = OleUIEditLinksA;
%END

CONST
    ELF_SHOWHELP                = 000000001h;
    ELF_DISABLEUPDATENOW        = 000000002h;
    ELF_DISABLEOPENSOURCE       = 000000004h;
    ELF_DISABLECHANGESOURCE     = 000000008h;
    ELF_DISABLECANCELLINK       = 000000010h;

TYPE
    OLEUICHANGEICONW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          hMetaPict      : HGLOBAL;
          clsid          : CLSID;
          szIconExe      : ARRAY [0..MAX_PATH-1] OF UCHAR;
          cchIconExe     : WINT;
    END;
    POLEUICHANGEICONW    = POINTER TO OLEUICHANGEICONW;
    LPOLEUICHANGEICONW   = POLEUICHANGEICONW;

    OLEUICHANGEICONA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          hMetaPict      : HGLOBAL;
          clsid          : CLSID;
          szIconExe      : ARRAY [0..MAX_PATH-1] OF ACHAR;
          cchIconExe     : WINT;
    END;
    POLEUICHANGEICONA    = POINTER TO OLEUICHANGEICONA;
    LPOLEUICHANGEICONA   = POLEUICHANGEICONA;

PROCEDURE OleUIChangeIconW(a : LPOLEUICHANGEICONW) : UINT;

PROCEDURE OleUIChangeIconA(a : LPOLEUICHANGEICONA) : UINT;

TYPE
%IF UNICODE %THEN
    OLEUICHANGEICON     = OLEUICHANGEICONW;
    POLEUICHANGEICON     = POLEUICHANGEICONW;
    LPOLEUICHANGEICON    = LPOLEUICHANGEICONW;

PROCEDURE OleUIChangeIcon = OleUIChangeIconW;
%ELSE

    OLEUICHANGEICON     = OLEUICHANGEICONA;
    POLEUICHANGEICON     = POLEUICHANGEICONA;
    LPOLEUICHANGEICON    = LPOLEUICHANGEICONA;

PROCEDURE OleUIChangeIcon = OleUIChangeIconA;
%END

CONST
    CIF_SHOWHELP         = 000000001h;
    CIF_SELECTCURRENT    = 000000002h;
    CIF_SELECTDEFAULT    = 000000004h;
    CIF_SELECTFROMFILE   = 000000008h;
    CIF_USEICONEXE       = 000000010h;

    OLEUI_CIERR_MUSTHAVECLSID           = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_CIERR_MUSTHAVECURRENTMETAFILE = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_CIERR_SZICONEXEINVALID        = OLEUI_ERR_STANDARDMAX + 2;

    PROP_HWND_CHGICONDLG                = "HWND_CIDLG";

TYPE
    OLEUICONVERTW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          clsid          : CLSID;
          clsidConvertDefault: CLSID;
          clsidActivateDefault: CLSID;
          clsidNew       : CLSID;
          dvAspect       : DWORD;
          wFormat        : WORD;
          fIsLinkedObject: BOOL;
          hMetaPict      : HGLOBAL;
          lpszUserType   : LPWSTR;
          fObjectsIconChanged: BOOL;
          lpszDefLabel   : LPWSTR;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
    END;
    POLEUICONVERTW       = POINTER TO OLEUICONVERTW;
    LPOLEUICONVERTW      = POLEUICONVERTW;

    OLEUICONVERTA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          clsid          : CLSID;
          clsidConvertDefault: CLSID;
          clsidActivateDefault: CLSID;
          clsidNew       : CLSID;
          dvAspect       : DWORD;
          wFormat        : WORD;
          fIsLinkedObject: BOOL;
          hMetaPict      : HGLOBAL;
          lpszUserType   : LPSTR;
          fObjectsIconChanged: BOOL;
          lpszDefLabel   : LPSTR;
          cClsidExclude  : UINT;
          lpClsidExclude : LPCLSID;
    END;
    POLEUICONVERTA       = POINTER TO OLEUICONVERTA;
    LPOLEUICONVERTA      = POLEUICONVERTA;

PROCEDURE OleUIConvertW(a : LPOLEUICONVERTW) : UINT;

PROCEDURE OleUIConvertA(a : LPOLEUICONVERTA) : UINT;

%IF UNICODE %THEN
TYPE
    OLEUICONVERT        = OLEUICONVERTW;
    POLEUICONVERT       = POLEUICONVERTW;
    LPOLEUICONVERT      = LPOLEUICONVERTW;

PROCEDURE OleUIConvert = OleUIConvertW;

%ELSE
TYPE
    OLEUICONVERT        = OLEUICONVERTA;
    POLEUICONVERT       = POLEUICONVERTA;
    LPOLEUICONVERT      = LPOLEUICONVERTA;

PROCEDURE OleUIConvert = OleUIConvertA;
%END

PROCEDURE OleUICanConvertOrActivateAs(rClsid : REFCLSID;
                                      fIsLinkedObject : BOOL;
                                      wFormat : WORD) : BOOL;


CONST
    CF_SHOWHELPBUTTON           = 000000001h;
    CF_SETCONVERTDEFAULT        = 000000002h;
    CF_SETACTIVATEDEFAULT       = 000000004h;
    CF_SELECTCONVERTTO          = 000000008h;
    CF_SELECTACTIVATEAS         = 000000010h;
    CF_DISABLEDISPLAYASICON     = 000000020h;
    CF_DISABLEACTIVATEAS        = 000000040h;
    CF_HIDECHANGEICON           = 000000080h;
    CF_CONVERTONLY              = 000000100h;

    OLEUI_CTERR_CLASSIDINVALID  = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_CTERR_DVASPECTINVALID = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_CTERR_CBFORMATINVALID = OLEUI_ERR_STANDARDMAX + 3;
    OLEUI_CTERR_HMETAPICTINVALID= OLEUI_ERR_STANDARDMAX + 4;
    OLEUI_CTERR_STRINGINVALID   = OLEUI_ERR_STANDARDMAX + 5;

TYPE
    OLEUIBUSYW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          hTask          : HTASK;
          lphWndDialog   : POINTER TO HWND;
    END;
    POLEUIBUSYW          = POINTER TO OLEUIBUSYW;
    LPOLEUIBUSYW         = POLEUIBUSYW;

    OLEUIBUSYA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          hTask          : HTASK;
          lphWndDialog   : POINTER TO HWND;
    END;
    POLEUIBUSYA          = POINTER TO OLEUIBUSYA;
    LPOLEUIBUSYA         = POLEUIBUSYA;

PROCEDURE OleUIBusyW(a : LPOLEUIBUSYW) : UINT;

PROCEDURE OleUIBusyA(a : LPOLEUIBUSYA) : UINT;

%IF UNICODE %THEN
TYPE
    OLEUIBUSY            = OLEUIBUSYW;
    POLEUIBUSY          = POLEUIBUSYW;
    LPOLEUIBUSY         = LPOLEUIBUSYW;

PROCEDURE OleUIBusy = OleUIBusyW;
%ELSE
TYPE
    OLEUIBUSY            = OLEUIBUSYA;
    POLEUIBUSY          = POLEUIBUSYA;
    LPOLEUIBUSY         = LPOLEUIBUSYA;

PROCEDURE OleUIBusy = OleUIBusyA;
%END

CONST
    BZ_DISABLECANCELBUTTON      = 000000001h;
    BZ_DISABLESWITCHTOBUTTON    = 000000002h;
    BZ_DISABLERETRYBUTTON       = 000000004h;
    BZ_NOTRESPONDINGDIALOG      = 000000008h;

    OLEUI_BZERR_HTASKINVALID    = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_BZ_SWITCHTOSELECTED   = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_BZ_RETRYSELECTED      = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_BZ_CALLUNBLOCKED      = OLEUI_ERR_STANDARDMAX + 3;

TYPE
    OLEUICHANGESOURCEW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCWSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCWSTR;
          hResource      : HRSRC;
          lpOFN          : OPENFILENAMEW;
          dwReserved1    : ARRAY [0..4 - 1] OF DWORD;
          lpOleUILinkContainer: IOleUILinkContainerW;
          dwLink         : DWORD;
          lpszDisplayName: LPWSTR;
          nFileLength    : ULONG;
          lpszFrom       : LPWSTR;
          lpszTo         : LPWSTR;
    END;
    POLEUICHANGESOURCEW  = POINTER TO OLEUICHANGESOURCEW;
    LPOLEUICHANGESOURCEW = POLEUICHANGESOURCEW;

    OLEUICHANGESOURCEA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          hWndOwner      : HWND;
          lpszCaption    : LPCSTR;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          hInstance      : HINSTANCE;
          lpszTemplate   : LPCSTR;
          hResource      : HRSRC;
          lpOFN          : OPENFILENAMEA;
          dwReserved1    : ARRAY [0..4 - 1] OF DWORD;
          lpOleUILinkContainer: IOleUILinkContainerA;
          dwLink         : DWORD;
          lpszDisplayName: LPSTR;
          nFileLength    : ULONG;
          lpszFrom       : LPSTR;
          lpszTo         : LPSTR;
    END;
    POLEUICHANGESOURCEA  = POINTER TO OLEUICHANGESOURCEA;
    LPOLEUICHANGESOURCEA = POLEUICHANGESOURCEA;

PROCEDURE OleUIChangeSourceW(a : LPOLEUICHANGESOURCEW) : UINT;

PROCEDURE OleUIChangeSourceA(a : LPOLEUICHANGESOURCEA) : UINT;

%IF UNICODE %THEN
TYPE
    OLEUICHANGESOURCE           = OLEUICHANGESOURCEW;
    POLEUICHANGESOURCE          = POLEUICHANGESOURCEW;
    LPOLEUICHANGESOURCE         = LPOLEUICHANGESOURCEW;

PROCEDURE OleUIChangeSource = OleUIChangeSourceW;
%ELSE
TYPE
    OLEUICHANGESOURCE           = OLEUICHANGESOURCEA;
    POLEUICHANGESOURCE          = POLEUICHANGESOURCEA;
    LPOLEUICHANGESOURCE         = LPOLEUICHANGESOURCEA;

PROCEDURE OleUIChangeSource = OleUIChangeSourceA;
%END

CONST
    CSF_SHOWHELP         = 000000001h;
    CSF_VALIDSOURCE      = 000000002h;
    CSF_ONLYGETSOURCE    = 000000004h;
    CSF_EXPLORER         = 000000008h;

    OLEUI_CSERR_LINKCNTRNULL            = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_CSERR_LINKCNTRINVALID         = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_CSERR_FROMNOTNULL             = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_CSERR_TONOTNULL               = OLEUI_ERR_STANDARDMAX + 3;
    OLEUI_CSERR_SOURCENULL              = OLEUI_ERR_STANDARDMAX + 4;
    OLEUI_CSERR_SOURCEINVALID           = OLEUI_ERR_STANDARDMAX + 5;
    OLEUI_CSERR_SOURCEPARSERROR         = OLEUI_ERR_STANDARDMAX + 6;
    OLEUI_CSERR_SOURCEPARSEERROR        = OLEUI_ERR_STANDARDMAX + 7;

ABSTRACT CLASS IOleUIObjInfoW;
INHERIT IUnknown;
REVEAL GetObjectInfo, GetConvertInfo, ConvertObject, GetViewInfo, SetViewInfo;

ABSTRACT PROCEDURE GetObjectInfo(object : DWORD;
                                 VAR objSize : DWORD;
                                 VAR label : LPWSTR;
                                 VAR fullType : LPWSTR;
                                 VAR shortType : LPWSTR;
                                 VAR location : LPWSTR) : HRESULT;

ABSTRACT PROCEDURE GetConvertInfo(object : DWORD;
                                  VAR classID : CLSID;
                                  VAR format : WORD;
                                  VAR convertDefaultClassID : CLSID;
                                  VAR excludeCLSID : LPCLSID;
                                  VAR exclude : UINT) : HRESULT;

ABSTRACT PROCEDURE ConvertObject(object : DWORD; clsidNew : CLSID) : HRESULT;

ABSTRACT PROCEDURE GetViewInfo(object : DWORD;
                               VAR metaPict : HGLOBAL;
                               VAR dvAspect : DWORD;
                               VAR currentScale : WINT) : HRESULT;

ABSTRACT PROCEDURE SetViewInfo(object : DWORD;
                               metaPict : HGLOBAL;
                               dvAspect : DWORD;
                               currentScale : WINT;
                               relativeToOrig : BOOL) : HRESULT;

END IOleUIObjInfoW;

ABSTRACT CLASS IOleUIObjInfoA;
INHERIT IUnknown;
REVEAL GetObjectInfo, GetConvertInfo, ConvertObject, GetViewInfo, SetViewInfo;

ABSTRACT PROCEDURE GetObjectInfo(object : DWORD;
                                 VAR objSize : DWORD;
                                 VAR label : LPSTR;
                                 VAR fullType : LPSTR;
                                 VAR shortType : LPSTR;
                                 VAR location : LPSTR) : HRESULT;

ABSTRACT PROCEDURE GetConvertInfo(object : DWORD;
                                  VAR classID : CLSID;
                                  VAR format : WORD;
                                  VAR convertDefaultClassID : CLSID;
                                  VAR excludeCLSID : LPCLSID;
                                  VAR exclude : UINT) : HRESULT;

ABSTRACT PROCEDURE ConvertObject(object : DWORD; clsidNew : CLSID) : HRESULT;

ABSTRACT PROCEDURE GetViewInfo(object : DWORD;
                               VAR metaPict : HGLOBAL;
                               VAR dvAspect : DWORD;
                               VAR currentScale : WINT) : HRESULT;

ABSTRACT PROCEDURE SetViewInfo(object : DWORD;
                               metaPict : HGLOBAL;
                               dvAspect : DWORD;
                               currentScale : WINT;
                               relativeToOrig : BOOL) : HRESULT;

END IOleUIObjInfoA;

TYPE
%IF UNICODE %THEN
    IOleUIObjInfo       = IOleUIObjInfoW;
%ELSE
    IOleUIObjInfo       = IOleUIObjInfoA;
%END

ABSTRACT CLASS IOleUILinkInfoW;
INHERIT IUnknown;
REVEAL GetNextLink, SetLinkUpdateOptions, GetLinkUpdateOptions,
       SetLinkSource, GetLinkSource, OpenLinkSource, UpdateLink,
       CancelLink, GetLastUpdate;

ABSTRACT PROCEDURE GetNextLink(link : DWORD) : DWORD;

ABSTRACT PROCEDURE SetLinkUpdateOptions(link : DWORD;
                                        updateLink : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLinkUpdateOptions(link : DWORD;
                                        VAR updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE SetLinkSource(link : DWORD;
                                 displayName : LPWSTR;
                                 displayNameLen : ULONG;
                                 VAR eaten : ULONG;
                                 validateSource : BOOL) : HRESULT;

ABSTRACT PROCEDURE GetLinkSource(link : DWORD;
                                 VAR displayName : LPWSTR;
                                 VAR fileNameLen : ULONG;
                                 VAR fullLinkType : LPWSTR;
                                 VAR showtLinkType : LPWSTR;
                                 VAR sourceAvailable : BOOL;
                                 VAR isSelected : BOOL) : HRESULT;

ABSTRACT PROCEDURE OpenLinkSource(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE UpdateLink(link : DWORD;
                              errorMessage : BOOL;
                              reserved : BOOL) : HRESULT;

ABSTRACT PROCEDURE CancelLink(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLastUpdate(link : DWORD;
                                 VAR lastUpdate : FILETIME) : HRESULT;

END IOleUILinkInfoW;

ABSTRACT CLASS IOleUILinkInfoA;
INHERIT IUnknown;
REVEAL GetNextLink, SetLinkUpdateOptions, GetLinkUpdateOptions,
       SetLinkSource, GetLinkSource, OpenLinkSource, UpdateLink,
       CancelLink, GetLastUpdate;

ABSTRACT PROCEDURE GetNextLink(link : DWORD) : DWORD;

ABSTRACT PROCEDURE SetLinkUpdateOptions(link : DWORD;
                                        updateLink : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLinkUpdateOptions(link : DWORD;
                                        VAR updateOpt : DWORD) : HRESULT;

ABSTRACT PROCEDURE SetLinkSource(link : DWORD;
                                 displayName : LPSTR;
                                 displayNameLen : ULONG;
                                 VAR eaten : ULONG;
                                 validateSource : BOOL) : HRESULT;

ABSTRACT PROCEDURE GetLinkSource(link : DWORD;
                                 VAR displayName : LPSTR;
                                 VAR fileNameLen : ULONG;
                                 VAR fullLinkType : LPSTR;
                                 VAR showtLinkType : LPSTR;
                                 VAR sourceAvailable : BOOL;
                                 VAR isSelected : BOOL) : HRESULT;

ABSTRACT PROCEDURE OpenLinkSource(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE UpdateLink(link : DWORD;
                              errorMessage : BOOL;
                              reserved : BOOL) : HRESULT;

ABSTRACT PROCEDURE CancelLink(link : DWORD) : HRESULT;

ABSTRACT PROCEDURE GetLastUpdate(link : DWORD;
                                 VAR lastUpdate : FILETIME) : HRESULT;

END IOleUILinkInfoA;

TYPE
%IF UNICODE %THEN
    IOleUILinkInfo      = IOleUILinkInfoW;
%ELSE
    IOleUILinkInfo      = IOleUILinkInfoA;
%END

TYPE
    OLEUIGNRLPROPSW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
          lpOP           : POINTER TO OLEUIOBJECTPROPSW;
    END;
    POLEUIGNRLPROPSW     = POINTER TO OLEUIGNRLPROPSW;
    LPOLEUIGNRLPROPSW    = POLEUIGNRLPROPSW;

    OLEUIGNRLPROPSA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
          lpOP           : POINTER TO OLEUIOBJECTPROPSA;
    END;
    POLEUIGNRLPROPSA     = POINTER TO OLEUIGNRLPROPSA;
    LPOLEUIGNRLPROPSA    = POLEUIGNRLPROPSA;

%IF UNICODE %THEN
    OLEUIGNRLPROPS      = OLEUIGNRLPROPSW;
    POLEUIGNRLPROPS     = POLEUIGNRLPROPSW;
    LPOLEUIGNRLPROPS    = LPOLEUIGNRLPROPSW;
%ELSE
    OLEUIGNRLPROPS      = OLEUIGNRLPROPSA;
    POLEUIGNRLPROPS     = POLEUIGNRLPROPSA;
    LPOLEUIGNRLPROPS    = LPOLEUIGNRLPROPSA;
%END

    OLEUIVIEWPROPSW = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
          lpOP           : POINTER TO OLEUIOBJECTPROPSW;
          nScaleMin      : WINT;
          nScaleMax      : WINT;
    END;
    POLEUIVIEWPROPSW     = POINTER TO OLEUIVIEWPROPSW;
    LPOLEUIVIEWPROPSW    = POLEUIVIEWPROPSW;

    OLEUIVIEWPROPSA = RECORD
          cbStruct       : DWORD;
          dwFlags        : DWORD;
          dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
          lpfnHook       : LPFNOLEUIHOOK;
          lCustData      : LPARAM;
          dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
          lpOP           : POINTER TO OLEUIOBJECTPROPSA;
          nScaleMin      : WINT;
          nScaleMax      : WINT;
    END;
    POLEUIVIEWPROPSA     = POINTER TO OLEUIVIEWPROPSA;
    LPOLEUIVIEWPROPSA    = POLEUIVIEWPROPSA;

%IF UNICODE %THEN
    OLEUIVIEWPROPS      = OLEUIVIEWPROPSW;
    POLEUIVIEWPROPS     = POLEUIVIEWPROPSW;
    LPOLEUIVIEWPROPS    = LPOLEUIVIEWPROPSW;
%ELSE
    OLEUIVIEWPROPS      = OLEUIVIEWPROPSA;
    POLEUIVIEWPROPS     = POLEUIVIEWPROPSA;
    LPOLEUIVIEWPROPS    = LPOLEUIVIEWPROPSA;
%END

CONST
    VPF_SELECTRELATIVE  = 000000001h;
    VPF_DISABLERELATIVE = 000000002h;
    VPF_DISABLESCALE    = 000000004h;

TYPE
    OLEUILINKPROPSW =
		RECORD
			cbStruct       : DWORD;
			dwFlags        : DWORD;
			dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
			lpfnHook       : LPFNOLEUIHOOK;
			lCustData      : LPARAM;
			dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
			lpOP           : POINTER TO OLEUIOBJECTPROPSW;
		END;
    POLEUILINKPROPSW     = POINTER TO OLEUILINKPROPSW;
    LPOLEUILINKPROPSW    = POLEUILINKPROPSW;

    OLEUILINKPROPSA =
		RECORD
			cbStruct       : DWORD;
			dwFlags        : DWORD;
			dwReserved1    : ARRAY [0..2 - 1] OF DWORD;
			lpfnHook       : LPFNOLEUIHOOK;
			lCustData      : LPARAM;
			dwReserved2    : ARRAY [0..3 - 1] OF DWORD;
			lpOP           : POINTER TO OLEUIOBJECTPROPSA;
		END;
    POLEUILINKPROPSA     = POINTER TO OLEUILINKPROPSA;
    LPOLEUILINKPROPSA    = POLEUILINKPROPSA;

%IF UNICODE %THEN
    OLEUILINKPROPS      = OLEUILINKPROPSW;
    POLEUILINKPROPS     = POLEUILINKPROPSW;
    LPOLEUILINKPROPS    = LPOLEUILINKPROPSW;
%ELSE
    OLEUILINKPROPS      = OLEUILINKPROPSA;
    POLEUILINKPROPS     = POLEUILINKPROPSA;
    LPOLEUILINKPROPS    = LPOLEUILINKPROPSA;
%END

    OLEUIOBJECTPROPSW =
		RECORD
			cbStruct                : DWORD;
			dwFlags                 : DWORD;
			lpPS                    : LPPROPSHEETHEADERW;
			dwObject                : DWORD;
			lpObjInfo               : IOleUIObjInfoW;
			dwLink                  : DWORD;
			lpLinkInfo              : IOleUILinkInfoW;
			lpGP                    : LPOLEUIGNRLPROPSW;
			lpVP                    : LPOLEUIVIEWPROPSW;
			lpLP                    : LPOLEUILINKPROPSW;
		END;
    POLEUIOBJECTPROPSW   = POINTER TO OLEUIOBJECTPROPSW;
    LPOLEUIOBJECTPROPSW  = POLEUIOBJECTPROPSW;

    OLEUIOBJECTPROPSA =
		RECORD
			cbStruct                : DWORD;
			dwFlags                 : DWORD;
			lpPS                    : LPPROPSHEETHEADERA;
			dwObject                : DWORD;
			lpObjInfo               : IOleUIObjInfoA;
			dwLink                  : DWORD;
			lpLinkInfo              : IOleUILinkInfoA;
			lpGP                    : LPOLEUIGNRLPROPSA;
			lpVP                    : LPOLEUIVIEWPROPSA;
			lpLP                    : LPOLEUILINKPROPSA;
		END;
    POLEUIOBJECTPROPSA   = POINTER TO OLEUIOBJECTPROPSA;
    LPOLEUIOBJECTPROPSA  = POLEUIOBJECTPROPSA;

PROCEDURE OleUIObjectPropertiesW(a : LPOLEUIOBJECTPROPSW) : UINT;

PROCEDURE OleUIObjectPropertiesA(a : LPOLEUIOBJECTPROPSA) : UINT;

%IF UNICODE %THEN
TYPE
    OLEUIOBJECTPROPS    = OLEUIOBJECTPROPSW;
    POLEUIOBJECTPROPS   = POLEUIOBJECTPROPSW;
    LPOLEUIOBJECTPROPS  = LPOLEUIOBJECTPROPSW;

PROCEDURE OleUIObjectProperties = OleUIObjectPropertiesW;
%ELSE
TYPE
    OLEUIOBJECTPROPS    = OLEUIOBJECTPROPSA;
    POLEUIOBJECTPROPS   = POLEUIOBJECTPROPSA;
    LPOLEUIOBJECTPROPS  = LPOLEUIOBJECTPROPSA;

PROCEDURE OleUIObjectProperties = OleUIObjectPropertiesA;
%END

CONST
    OPF_OBJECTISLINK     = 000000001h;
    OPF_NOFILLDEFAULT    = 000000002h;
    OPF_SHOWHELP         = 000000004h;
    OPF_DISABLECONVERT   = 000000008h;

    OLEUI_OPERR_SUBPROPNULL             = OLEUI_ERR_STANDARDMAX + 0;
    OLEUI_OPERR_SUBPROPINVALID          = OLEUI_ERR_STANDARDMAX + 1;
    OLEUI_OPERR_PROPSHEETNULL           = OLEUI_ERR_STANDARDMAX + 2;
    OLEUI_OPERR_PROPSHEETINVALID        = OLEUI_ERR_STANDARDMAX + 3;
    OLEUI_OPERR_SUPPROP                 = OLEUI_ERR_STANDARDMAX + 4;
    OLEUI_OPERR_PROPSINVALID            = OLEUI_ERR_STANDARDMAX + 5;
    OLEUI_OPERR_PAGESINCORRECT          = OLEUI_ERR_STANDARDMAX + 6;
    OLEUI_OPERR_INVALIDPAGES            = OLEUI_ERR_STANDARDMAX + 7;
    OLEUI_OPERR_NOTSUPPORTED            = OLEUI_ERR_STANDARDMAX + 8;
    OLEUI_OPERR_DLGPROCNOTNULL          = OLEUI_ERR_STANDARDMAX + 9;
    OLEUI_OPERR_LPARAMNOTZERO           = OLEUI_ERR_STANDARDMAX + 10;
    OLEUI_GPERR_STRINGINVALID           = OLEUI_ERR_STANDARDMAX + 11;
    OLEUI_GPERR_CLASSIDINVALID          = OLEUI_ERR_STANDARDMAX + 12;
    OLEUI_GPERR_LPCLSIDEXCLUDEINVALID   = OLEUI_ERR_STANDARDMAX + 13;
    OLEUI_GPERR_CBFORMATINVALID         = OLEUI_ERR_STANDARDMAX + 14;
    OLEUI_VPERR_METAPICTINVALID         = OLEUI_ERR_STANDARDMAX + 15;
    OLEUI_VPERR_DVASPECTINVALID         = OLEUI_ERR_STANDARDMAX + 16;
    OLEUI_LPERR_LINKCNTRNULL            = OLEUI_ERR_STANDARDMAX + 17;
    OLEUI_LPERR_LINKCNTRINVALID         = OLEUI_ERR_STANDARDMAX + 18;
    OLEUI_OPERR_PROPERTYSHEET           = OLEUI_ERR_STANDARDMAX + 19;
    OLEUI_OPERR_OBJINFOINVALID          = OLEUI_ERR_STANDARDMAX + 20;
    OLEUI_OPERR_LINKINFOINVALID         = OLEUI_ERR_STANDARDMAX + 21;


    OLEUI_QUERY_GETCLASSID              = 0FF00h;
    OLEUI_QUERY_LINKBROKEN              = 0FF01h;

PROCEDURE OleUIPromptUserW(nTemplate : WINT;
                           hwndParent : HWND) : WINT [VARIABLE, msCDECL];

PROCEDURE OleUIPromptUserA(nTemplate : WINT;
                           hwndParent : HWND) : WINT [VARIABLE, msCDECL];

%IF UNICODE %THEN
PROCEDURE OleUIPromptUser = OleUIPromptUserW;
%ELSE
PROCEDURE OleUIPromptUser = OleUIPromptUserA;
%END

PROCEDURE OleUIUpdateLinksW(lpOleUILinkCntr : IOleUILinkContainerW;
                            hwndParent : HWND;
                            lpszTitle : LPWSTR;
                            cLinks : WINT) : BOOL;

PROCEDURE OleUIUpdateLinksA(lpOleUILinkCntr : IOleUILinkContainerA;
                            hwndParent : HWND;
                            lpszTitle : LPSTR;
                            cLinks : WINT) : BOOL;

%IF UNICODE %THEN
PROCEDURE OleUIUpdateLinks = OleUIUpdateLinksW;
%ELSE
PROCEDURE OleUIUpdateLinks = OleUIUpdateLinksA;
%END

END OleDlg.
